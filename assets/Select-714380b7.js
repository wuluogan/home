import{e,s as n,O as t,a8 as o,y as l,D as i,bh as r,f as a,bi as s,a7 as u,Z as d,E as c,K as h,z as p,bj as v,V as f,am as b,bk as g,bl as m,i as w,bm as y,N as x,ac as C,$ as F,a4 as S,a0 as R,P as O,a3 as T,a1 as k,A as z,Y as M,aa as P,bf as B,ab as I,bg as $,M as A,H as L,W as E,Q as D,F as N,bn as W,C as j,ak as _,aJ as K,m as V,v as H,aL as U,aK as q,bo as G,X as Y}from"./index-c72c5b0c.js";import{u as X}from"./use-merged-state-74230ec8.js";import{a as J,h as Q,c as Z}from"./create-07671515.js";import{a as ee,u as ne}from"./Suffix-af55cfcd.js";import{u as te}from"./use-compitable-a1866e01.js";import{i as oe,a as le,s as ie}from"./light-20fa43af.js";import{_ as re}from"./Tag-827106b2.js";import{c as ae,a as se}from"./cssr-ed8d5782.js";import{_ as ue}from"./Popover-87b27d79.js";import{i as de,c as ce,u as he,V as pe,a as ve,b as fe}from"./Follower-ef4b8179.js";import{b as be}from"./next-frame-once-924ab492.js";import{_ as ge}from"./Empty-3e1da814.js";function me(e){switch(typeof e){case"string":return e||void 0;case"number":return String(e);default:return}}function we(e){const n=e.filter((e=>void 0!==e));if(0!==n.length)return 1===n.length?n[0]:n=>{e.forEach((e=>{e&&e(n)}))}}function ye(e){return e&-e}class xe{constructor(e,n){this.l=e,this.min=n;const t=new Array(e+1);for(let o=0;o<e+1;++o)t[o]=0;this.ft=t}add(e,n){if(0===n)return;const{l:t,ft:o}=this;for(e+=1;e<=t;)o[e]+=n,e+=ye(e)}get(e){return this.sum(e+1)-this.sum(e)}sum(e){if(void 0===e&&(e=this.l),e<=0)return 0;const{ft:n,min:t,l:o}=this;if(e>o)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let l=e*t;for(;e>0;)l+=n[e],e-=ye(e);return l}getBound(e){let n=0,t=this.l;for(;t>n;){const o=Math.floor((n+t)/2),l=this.sum(o);if(l>e)t=o;else{if(!(l<e))return o;if(n===o)return this.sum(n+1)<=e?n+1:o;n=o}}return n}}let Ce,Fe;function Se(){return"undefined"==typeof document?1:(void 0===Fe&&(Fe="chrome"in window?window.devicePixelRatio:1),Fe)}const Re="VVirtualListXScroll";const Oe=l({name:"VirtualListRow",props:{index:{type:Number,required:!0},item:{type:Object,required:!0}},setup(){const{startIndexRef:e,endIndexRef:n,columnsRef:t,getLeft:o,renderColRef:l,renderItemWithColsRef:r}=i(Re);return{startIndex:e,endIndex:n,columns:t,renderCol:l,renderItemWithCols:r,getLeft:o}},render(){const{startIndex:e,endIndex:n,columns:t,renderCol:o,renderItemWithCols:l,getLeft:i,item:r}=this;if(null!=l)return l({itemIndex:this.index,startColIndex:e,endColIndex:n,allColumns:t,item:r,getLeft:i});if(null!=o){const l=[];for(let a=e;a<=n;++a){const e=t[a];l.push(o({column:e,left:i(a),item:r}))}return l}return null}}),Te=ae(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[ae("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[ae("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),ke=l({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]},renderCol:Function,renderItemWithCols:Function,items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(l){const i=r();Te.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:se,ssr:i}),a((()=>{const{defaultScrollIndex:e,defaultScrollKey:n}=l;null!=e?T({index:e}):null!=n&&T({key:n})}));let p=!1,v=!1;s((()=>{p=!1,v?T({top:S.value,left:g.value}):v=!0})),u((()=>{p=!0,v||(v=!0)}));const f=t((()=>{if(null==l.renderCol&&null==l.renderItemWithCols)return;if(0===l.columns.length)return;let e=0;return l.columns.forEach((n=>{e+=n.width})),e})),b=n((()=>{const e=new Map,{keyField:n}=l;return l.items.forEach(((t,o)=>{e.set(t[n],o)})),e})),{scrollLeftRef:g,listWidthRef:m}=function({columnsRef:l,renderColRef:i,renderItemWithColsRef:r}){const a=e(0),s=e(0),u=n((()=>{const e=l.value;if(0===e.length)return null;const n=new xe(e.length,0);return e.forEach(((e,t)=>{n.add(t,e.width)})),n})),d=t((()=>{const e=u.value;return null!==e?Math.max(e.getBound(s.value)-1,0):0})),c=t((()=>{const e=u.value;return null!==e?Math.min(e.getBound(s.value+a.value)+1,l.value.length-1):0}));return o(Re,{startIndexRef:d,endIndexRef:c,columnsRef:l,renderColRef:i,renderItemWithColsRef:r,getLeft:e=>{const n=u.value;return null!==n?n.sum(e):0}}),{listWidthRef:a,scrollLeftRef:s}}({columnsRef:d(l,"columns"),renderColRef:d(l,"renderCol"),renderItemWithColsRef:d(l,"renderItemWithCols")}),w=e(null),y=e(void 0),x=new Map,C=n((()=>{const{items:e,itemSize:n,keyField:t}=l,o=new xe(e.length,n);return e.forEach(((e,n)=>{const l=e[t],i=x.get(l);void 0!==i&&o.add(n,i)})),o})),F=e(0),S=e(0),R=t((()=>Math.max(C.value.getBound(S.value-c(l.paddingTop))-1,0))),O=n((()=>{const{value:e}=y;if(void 0===e)return[];const{items:n,itemSize:t}=l,o=R.value,i=Math.min(o+Math.ceil(e/t+1),n.length-1),r=[];for(let l=o;l<=i;++l)r.push(n[l]);return r})),T=(e,n)=>{if("number"==typeof e)return void P(e,n,"auto");const{left:t,top:o,index:l,key:i,position:r,behavior:a,debounce:s=!0}=e;if(void 0!==t||void 0!==o)P(t,o,a);else if(void 0!==l)M(l,a,s);else if(void 0!==i){const e=b.value.get(i);void 0!==e&&M(e,a,s)}else"bottom"===r?P(0,Number.MAX_SAFE_INTEGER,a):"top"===r&&P(0,0,a)};let k,z=null;function M(e,n,t){const{value:o}=C,i=o.sum(e)+c(l.paddingTop);if(t){k=e,null!==z&&window.clearTimeout(z),z=window.setTimeout((()=>{k=void 0,z=null}),16);const{scrollTop:t,offsetHeight:l}=w.value;if(i>t){const r=o.get(e);i+r<=t+l||w.value.scrollTo({left:0,top:i+r-l,behavior:n})}else w.value.scrollTo({left:0,top:i,behavior:n})}else w.value.scrollTo({left:0,top:i,behavior:n})}function P(e,n,t){w.value.scrollTo({left:e,top:n,behavior:t})}const B=!("undefined"!=typeof document&&(void 0===Ce&&(Ce="matchMedia"in window&&window.matchMedia("(pointer:coarse)").matches),Ce));let I=!1;function $(){const{value:e}=w;null!=e&&(S.value=e.scrollTop,g.value=e.scrollLeft)}function A(e){let n=e;for(;null!==n;){if("none"===n.style.display)return!0;n=n.parentElement}return!1}return{listHeight:y,listStyle:{overflow:"auto"},keyToIndex:b,itemsStyle:n((()=>{const{itemResizable:e}=l,n=h(C.value.sum());return F.value,[l.itemsStyle,{boxSizing:"content-box",width:h(f.value),height:e?"":n,minHeight:e?n:"",paddingTop:h(l.paddingTop),paddingBottom:h(l.paddingBottom)}]})),visibleItemsStyle:n((()=>(F.value,{transform:`translateY(${h(C.value.sum(R.value))})`}))),viewportItems:O,listElRef:w,itemsElRef:e(null),scrollTo:T,handleListResize:function(e){if(p)return;if(A(e.target))return;if(null==l.renderCol&&null==l.renderItemWithCols){if(e.contentRect.height===y.value)return}else if(e.contentRect.height===y.value&&e.contentRect.width===m.value)return;y.value=e.contentRect.height,m.value=e.contentRect.width;const{onResize:n}=l;void 0!==n&&n(e)},handleListScroll:function(e){var n;null===(n=l.onScroll)||void 0===n||n.call(l,e),B&&I||$()},handleListWheel:function(e){var n;if(null===(n=l.onWheel)||void 0===n||n.call(l,e),B){const n=w.value;if(null!=n){if(0===e.deltaX){if(0===n.scrollTop&&e.deltaY<=0)return;if(n.scrollTop+n.offsetHeight>=n.scrollHeight&&e.deltaY>=0)return}e.preventDefault(),n.scrollTop+=e.deltaY/Se(),n.scrollLeft+=e.deltaX/Se(),$(),I=!0,be((()=>{I=!1}))}}},handleItemResize:function(e,n){var t,o,i;if(p)return;if(l.ignoreItemResize)return;if(A(n.target))return;const{value:r}=C,a=b.value.get(e),s=r.get(a),u=null!==(i=null===(o=null===(t=n.borderBoxSize)||void 0===t?void 0:t[0])||void 0===o?void 0:o.blockSize)&&void 0!==i?i:n.contentRect.height;if(u===s)return;0===u-l.itemSize?x.delete(e):x.set(e,u-l.itemSize);const d=u-s;if(0===d)return;r.add(a,d);const c=w.value;if(null!=c){if(void 0===k){const e=r.sum(a);c.scrollTop>e&&c.scrollBy(0,d)}else if(a<k)c.scrollBy(0,d);else if(a===k){u+r.sum(a)>c.scrollTop+c.offsetHeight&&c.scrollBy(0,d)}$()}F.value++}}},render(){const{itemResizable:e,keyField:n,keyToIndex:t,visibleItemsTag:o}=this;return p(f,{onResize:this.handleListResize},{default:()=>{var l,i;return p("div",v(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[0!==this.items.length?p("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[p(o,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>{const{renderCol:o,renderItemWithCols:l}=this;return this.viewportItems.map((i=>{const r=i[n],a=t.get(r),s=null!=o?p(Oe,{index:a,item:i}):void 0,u=null!=l?p(Oe,{index:a,item:i}):void 0,d=this.$slots.default({item:i,renderedCols:s,renderedItemWithCols:u,index:a})[0];return e?p(f,{key:r,onResize:e=>this.handleItemResize(r,e)},{default:()=>d}):(d.key=r,d)}))}})]):null===(i=(l=this.$slots).empty)||void 0===i?void 0:i.call(l)])}})}}),ze="v-hidden",Me=ae("[v-hidden]",{display:"none!important"}),Pe=l({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(n,{slots:t}){const o=e(null),l=e(null);function i(e){const{value:i}=o,{getCounter:r,getTail:a}=n;let s;if(s=void 0!==r?r():l.value,!i||!s)return;s.hasAttribute(ze)&&s.removeAttribute(ze);const{children:u}=i;if(e.showAllItemsBeforeCalculate)for(const n of u)n.hasAttribute(ze)&&n.removeAttribute(ze);const d=i.offsetWidth,c=[],h=t.tail?null==a?void 0:a():null;let p=h?h.offsetWidth:0,v=!1;const f=i.children.length-(t.tail?1:0);for(let t=0;t<f-1;++t){if(t<0)continue;const e=u[t];if(v){e.hasAttribute(ze)||e.setAttribute(ze,"");continue}e.hasAttribute(ze)&&e.removeAttribute(ze);const o=e.offsetWidth;if(p+=o,c[t]=o,p>d){const{updateCounter:e}=n;for(let o=t;o>=0;--o){const l=f-1-o;void 0!==e?e(l):s.textContent=`${l}`;const i=s.offsetWidth;if(p-=c[o],p+i<=d||0===o){v=!0,t=o-1,h&&(-1===t?(h.style.maxWidth=d-i+"px",h.style.boxSizing="border-box"):h.style.maxWidth="");const{onUpdateCount:e}=n;e&&e(l);break}}}}const{onUpdateOverflow:b}=n;v?void 0!==b&&b(!0):(void 0!==b&&b(!1),s.setAttribute(ze,""))}const s=r();return Me.mount({id:"vueuc/overflow",head:!0,anchorMetaName:se,ssr:s}),a((()=>i({showAllItemsBeforeCalculate:!1}))),{selfRef:o,counterRef:l,sync:i}},render(){const{$slots:e}=this;return b((()=>this.sync({showAllItemsBeforeCalculate:!1}))),p("div",{class:"v-overflow",ref:"selfRef"},[g(e,"default"),e.counter?e.counter():p("span",{style:{display:"inline-block"},ref:"counterRef"}),e.tail?e.tail():null])}});function Be(e,n){n&&(a((()=>{const{value:t}=e;t&&m.registerHandler(t,n)})),w((()=>{const{value:n}=e;n&&m.unregisterHandler(n)})))}const Ie=l({name:"Checkmark",render:()=>p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},p("g",{fill:"none"},p("path",{d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z",fill:"currentColor"})))}),$e=l({props:{onFocus:Function,onBlur:Function},setup:e=>()=>p("div",{style:"width: 0; height: 0",tabindex:0,onFocus:e.onFocus,onBlur:e.onBlur})});const Ae=l({name:"NBaseSelectOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const{valueRef:n,pendingTmNodeRef:o,multipleRef:l,valueSetRef:r,renderLabelRef:a,renderOptionRef:s,labelFieldRef:u,valueFieldRef:d,showCheckmarkRef:c,nodePropsRef:h,handleOptionClick:p,handleOptionMouseEnter:v}=i(de),f=t((()=>{const{value:n}=o;return!!n&&e.tmNode.key===n.key}));return{multiple:l,isGrouped:t((()=>{const{tmNode:n}=e,{parent:t}=n;return t&&"group"===t.rawNode.type})),showCheckmark:c,nodeProps:h,isPending:f,isSelected:t((()=>{const{value:t}=n,{value:o}=l;if(null===t)return!1;const i=e.tmNode.rawNode[d.value];if(o){const{value:e}=r;return e.has(i)}return t===i})),labelField:u,renderLabel:a,renderOption:s,handleMouseMove:function(n){const{tmNode:t}=e,{value:o}=f;t.disabled||o||v(n,t)},handleMouseEnter:function(n){const{tmNode:t}=e;t.disabled||v(n,t)},handleClick:function(n){const{tmNode:t}=e;t.disabled||p(n,t)}}},render(){const{clsPrefix:e,tmNode:{rawNode:n},isSelected:t,isPending:o,isGrouped:l,showCheckmark:i,nodeProps:r,renderOption:a,renderLabel:s,handleClick:u,handleMouseEnter:d,handleMouseMove:c}=this,h=function(e,n){return p(C,{name:"fade-in-scale-up-transition"},{default:()=>e?p(x,{clsPrefix:n,class:`${n}-base-select-option__check`},{default:()=>p(Ie)}):null})}(t,e),v=s?[s(n,t),i&&h]:[y(n[this.labelField],n,t),i&&h],f=null==r?void 0:r(n),b=p("div",Object.assign({},f,{class:[`${e}-base-select-option`,n.class,null==f?void 0:f.class,{[`${e}-base-select-option--disabled`]:n.disabled,[`${e}-base-select-option--selected`]:t,[`${e}-base-select-option--grouped`]:l,[`${e}-base-select-option--pending`]:o,[`${e}-base-select-option--show-checkmark`]:i}],style:[(null==f?void 0:f.style)||"",n.style||""],onClick:we([u,null==f?void 0:f.onClick]),onMouseenter:we([d,null==f?void 0:f.onMouseenter]),onMousemove:we([c,null==f?void 0:f.onMousemove])}),p("div",{class:`${e}-base-select-option__content`},v));return n.render?n.render({node:b,option:n,selected:t}):a?a({node:b,option:n,selected:t}):b}}),Le=l({name:"NBaseSelectGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{renderLabelRef:e,renderOptionRef:n,labelFieldRef:t,nodePropsRef:o}=i(de);return{labelField:t,nodeProps:o,renderLabel:e,renderOption:n}},render(){const{clsPrefix:e,renderLabel:n,renderOption:t,nodeProps:o,tmNode:{rawNode:l}}=this,i=null==o?void 0:o(l),r=n?n(l,!1):y(l[this.labelField],l,!1),a=p("div",Object.assign({},i,{class:[`${e}-base-select-group-header`,null==i?void 0:i.class]}),r);return l.render?l.render({node:a,option:l}):t?t({node:a,option:l,selected:!1}):a}}),Ee=F("base-select-menu","\n line-height: 1.5;\n outline: none;\n z-index: 0;\n position: relative;\n border-radius: var(--n-border-radius);\n transition:\n background-color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n background-color: var(--n-color);\n",[F("scrollbar","\n max-height: var(--n-height);\n "),F("virtual-list","\n max-height: var(--n-height);\n "),F("base-select-option","\n min-height: var(--n-option-height);\n font-size: var(--n-option-font-size);\n display: flex;\n align-items: center;\n ",[S("content","\n z-index: 1;\n white-space: nowrap;\n text-overflow: ellipsis;\n overflow: hidden;\n ")]),F("base-select-group-header","\n min-height: var(--n-option-height);\n font-size: .93em;\n display: flex;\n align-items: center;\n "),F("base-select-menu-option-wrapper","\n position: relative;\n width: 100%;\n "),S("loading, empty","\n display: flex;\n padding: 12px 32px;\n flex: 1;\n justify-content: center;\n "),S("loading","\n color: var(--n-loading-color);\n font-size: var(--n-loading-size);\n "),S("action","\n padding: 8px var(--n-option-padding-left);\n font-size: var(--n-option-font-size);\n transition: \n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n border-top: 1px solid var(--n-action-divider-color);\n color: var(--n-action-text-color);\n "),F("base-select-group-header","\n position: relative;\n cursor: default;\n padding: var(--n-option-padding);\n color: var(--n-group-header-text-color);\n "),F("base-select-option","\n cursor: pointer;\n position: relative;\n padding: var(--n-option-padding);\n transition:\n color .3s var(--n-bezier),\n opacity .3s var(--n-bezier);\n box-sizing: border-box;\n color: var(--n-option-text-color);\n opacity: 1;\n ",[R("show-checkmark","\n padding-right: calc(var(--n-option-padding-right) + 20px);\n "),O("&::before",'\n content: "";\n position: absolute;\n left: 4px;\n right: 4px;\n top: 0;\n bottom: 0;\n border-radius: var(--n-border-radius);\n transition: background-color .3s var(--n-bezier);\n '),O("&:active","\n color: var(--n-option-text-color-pressed);\n "),R("grouped","\n padding-left: calc(var(--n-option-padding-left) * 1.5);\n "),R("pending",[O("&::before","\n background-color: var(--n-option-color-pending);\n ")]),R("selected","\n color: var(--n-option-text-color-active);\n ",[O("&::before","\n background-color: var(--n-option-color-active);\n "),R("pending",[O("&::before","\n background-color: var(--n-option-color-active-pending);\n ")])]),R("disabled","\n cursor: not-allowed;\n ",[T("selected","\n color: var(--n-option-text-color-disabled);\n "),R("selected","\n opacity: var(--n-option-opacity-disabled);\n ")]),S("check","\n font-size: 16px;\n position: absolute;\n right: calc(var(--n-option-padding-right) - 4px);\n top: calc(50% - 7px);\n color: var(--n-option-check-color);\n transition: color .3s var(--n-bezier);\n ",[k({enterScale:"0.5"})])])]),De=l({name:"InternalSelectMenu",props:Object.assign(Object.assign({},z.props),{clsPrefix:{type:String,required:!0},scrollable:{type:Boolean,default:!0},treeMate:{type:Object,required:!0},multiple:Boolean,size:{type:String,default:"medium"},value:{type:[String,Number,Array],default:null},autoPending:Boolean,virtualScroll:{type:Boolean,default:!0},show:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},loading:Boolean,focusable:Boolean,renderLabel:Function,renderOption:Function,nodeProps:Function,showCheckmark:{type:Boolean,default:!0},onMousedown:Function,onScroll:Function,onFocus:Function,onBlur:Function,onKeyup:Function,onKeydown:Function,onTabOut:Function,onMouseenter:Function,onMouseleave:Function,onResize:Function,resetMenuOnOptionsChange:{type:Boolean,default:!0},inlineThemeDisabled:Boolean,onToggle:Function}),setup(t){const l=z("InternalSelectMenu","-internal-select-menu",Ee,oe,t,d(t,"clsPrefix")),i=e(null),r=e(null),s=e(null),u=n((()=>t.treeMate.getFlattenedNodes())),h=n((()=>J(u.value))),p=e(null);function v(){const{value:e}=p;e&&!t.treeMate.getNode(e.key)&&(p.value=null)}let f;M((()=>t.show),(e=>{e?f=M((()=>t.treeMate),(()=>{t.resetMenuOnOptionsChange?(t.autoPending?function(){const{treeMate:e}=t;let n=null;const{value:o}=t;null===o?n=e.getFirstAvailableNode():(n=t.multiple?e.getNode((o||[])[(o||[]).length-1]):e.getNode(o),n&&!n.disabled||(n=e.getFirstAvailableNode())),F(n||null)}():v(),b(S)):v()}),{immediate:!0}):null==f||f()}),{immediate:!0}),w((()=>{null==f||f()}));const g=n((()=>c(l.value.self[P("optionHeight",t.size)]))),m=n((()=>B(l.value.self[P("padding",t.size)]))),y=n((()=>t.multiple&&Array.isArray(t.value)?new Set(t.value):new Set)),x=n((()=>{const e=u.value;return e&&0===e.length}));function C(e){const{onScroll:n}=t;n&&n(e)}function F(e,n=!1){p.value=e,n&&S()}function S(){var e,n;const o=p.value;if(!o)return;const l=h.value(o.key);null!==l&&(t.virtualScroll?null===(e=r.value)||void 0===e||e.scrollTo({index:l}):null===(n=s.value)||void 0===n||n.scrollTo({index:l,elSize:g.value}))}o(de,{handleOptionMouseEnter:function(e,n){n.disabled||F(n,!1)},handleOptionClick:function(e,n){n.disabled||function(e){const{onToggle:n}=t;n&&n(e)}(n)},valueSetRef:y,pendingTmNodeRef:p,nodePropsRef:d(t,"nodeProps"),showCheckmarkRef:d(t,"showCheckmark"),multipleRef:d(t,"multiple"),valueRef:d(t,"value"),renderLabelRef:d(t,"renderLabel"),renderOptionRef:d(t,"renderOption"),labelFieldRef:d(t,"labelField"),valueFieldRef:d(t,"valueField")}),o(ce,i),a((()=>{const{value:e}=s;e&&e.sync()}));const R=n((()=>{const{size:e}=t,{common:{cubicBezierEaseInOut:n},self:{height:o,borderRadius:i,color:r,groupHeaderTextColor:a,actionDividerColor:s,optionTextColorPressed:u,optionTextColor:d,optionTextColorDisabled:c,optionTextColorActive:h,optionOpacityDisabled:p,optionCheckColor:v,actionTextColor:f,optionColorPending:b,optionColorActive:g,loadingColor:m,loadingSize:w,optionColorActivePending:y,[P("optionFontSize",e)]:x,[P("optionHeight",e)]:C,[P("optionPadding",e)]:F}}=l.value;return{"--n-height":o,"--n-action-divider-color":s,"--n-action-text-color":f,"--n-bezier":n,"--n-border-radius":i,"--n-color":r,"--n-option-font-size":x,"--n-group-header-text-color":a,"--n-option-check-color":v,"--n-option-color-pending":b,"--n-option-color-active":g,"--n-option-color-active-pending":y,"--n-option-height":C,"--n-option-opacity-disabled":p,"--n-option-text-color":d,"--n-option-text-color-active":h,"--n-option-text-color-disabled":c,"--n-option-text-color-pressed":u,"--n-option-padding":F,"--n-option-padding-left":B(F,"left"),"--n-option-padding-right":B(F,"right"),"--n-loading-color":m,"--n-loading-size":w}})),{inlineThemeDisabled:O}=t,T=O?I("internal-select-menu",n((()=>t.size[0])),R,t):void 0,k={selfRef:i,next:function(){const{value:e}=p;e&&F(e.getNext({loop:!0}),!0)},prev:function(){const{value:e}=p;e&&F(e.getPrev({loop:!0}),!0)},getPendingTmNode:function(){const{value:e}=p;return e||null}};return Be(i,t.onResize),Object.assign({mergedTheme:l,virtualListRef:r,scrollbarRef:s,itemSize:g,padding:m,flattenedNodes:u,empty:x,virtualListContainer(){const{value:e}=r;return null==e?void 0:e.listElRef},virtualListContent(){const{value:e}=r;return null==e?void 0:e.itemsElRef},doScroll:C,handleFocusin:function(e){var n,o;(null===(n=i.value)||void 0===n?void 0:n.contains(e.target))&&(null===(o=t.onFocus)||void 0===o||o.call(t,e))},handleFocusout:function(e){var n,o;(null===(n=i.value)||void 0===n?void 0:n.contains(e.relatedTarget))||null===(o=t.onBlur)||void 0===o||o.call(t,e)},handleKeyUp:function(e){var n;Q(e,"action")||null===(n=t.onKeyup)||void 0===n||n.call(t,e)},handleKeyDown:function(e){var n;Q(e,"action")||null===(n=t.onKeydown)||void 0===n||n.call(t,e)},handleMouseDown:function(e){var n;null===(n=t.onMousedown)||void 0===n||n.call(t,e),t.focusable||e.preventDefault()},handleVirtualListResize:function(){var e;null===(e=s.value)||void 0===e||e.sync()},handleVirtualListScroll:function(e){var n;null===(n=s.value)||void 0===n||n.sync(),C(e)},cssVars:O?void 0:R,themeClass:null==T?void 0:T.themeClass,onRender:null==T?void 0:T.onRender},k)},render(){const{$slots:e,virtualScroll:n,clsPrefix:t,mergedTheme:o,themeClass:l,onRender:i}=this;return null==i||i(),p("div",{ref:"selfRef",tabindex:this.focusable?0:-1,class:[`${t}-base-select-menu`,l,this.multiple&&`${t}-base-select-menu--multiple`],style:this.cssVars,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeyup:this.handleKeyUp,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseleave},this.loading?p("div",{class:`${t}-base-select-menu__loading`},p(A,{clsPrefix:t,strokeWidth:20})):this.empty?p("div",{class:`${t}-base-select-menu__empty`,"data-empty":!0},E(e.empty,(()=>[p(ge,{theme:o.peers.Empty,themeOverrides:o.peerOverrides.Empty})]))):p(L,{ref:"scrollbarRef",theme:o.peers.Scrollbar,themeOverrides:o.peerOverrides.Scrollbar,scrollable:this.scrollable,container:n?this.virtualListContainer:void 0,content:n?this.virtualListContent:void 0,onScroll:n?void 0:this.doScroll},{default:()=>n?p(ke,{ref:"virtualListRef",class:`${t}-virtual-list`,items:this.flattenedNodes,itemSize:this.itemSize,showScrollbar:!1,paddingTop:this.padding.top,paddingBottom:this.padding.bottom,onResize:this.handleVirtualListResize,onScroll:this.handleVirtualListScroll,itemResizable:!0},{default:({item:e})=>e.isGroup?p(Le,{key:e.key,clsPrefix:t,tmNode:e}):e.ignored?null:p(Ae,{clsPrefix:t,key:e.key,tmNode:e})}):p("div",{class:`${t}-base-select-menu-option-wrapper`,style:{paddingTop:this.padding.top,paddingBottom:this.padding.bottom}},this.flattenedNodes.map((e=>e.isGroup?p(Le,{key:e.key,clsPrefix:t,tmNode:e}):p(Ae,{clsPrefix:t,key:e.key,tmNode:e}))))}),$(e.action,(e=>e&&[p("div",{class:`${t}-base-select-menu__action`,"data-action":!0,key:"action"},e),p($e,{onFocus:this.onTabOut,key:"focus-detector"})])))}}),Ne=O([F("base-selection","\n position: relative;\n z-index: auto;\n box-shadow: none;\n width: 100%;\n max-width: 100%;\n display: inline-block;\n vertical-align: bottom;\n border-radius: var(--n-border-radius);\n min-height: var(--n-height);\n line-height: 1.5;\n font-size: var(--n-font-size);\n ",[F("base-loading","\n color: var(--n-loading-color);\n "),F("base-selection-tags","min-height: var(--n-height);"),S("border, state-border","\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n pointer-events: none;\n border: var(--n-border);\n border-radius: inherit;\n transition:\n box-shadow .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n "),S("state-border","\n z-index: 1;\n border-color: #0000;\n "),F("base-suffix","\n cursor: pointer;\n position: absolute;\n top: 50%;\n transform: translateY(-50%);\n right: 10px;\n ",[S("arrow","\n font-size: var(--n-arrow-size);\n color: var(--n-arrow-color);\n transition: color .3s var(--n-bezier);\n ")]),F("base-selection-overlay","\n display: flex;\n align-items: center;\n white-space: nowrap;\n pointer-events: none;\n position: absolute;\n top: 0;\n right: 0;\n bottom: 0;\n left: 0;\n padding: var(--n-padding-single);\n transition: color .3s var(--n-bezier);\n ",[S("wrapper","\n flex-basis: 0;\n flex-grow: 1;\n overflow: hidden;\n text-overflow: ellipsis;\n ")]),F("base-selection-placeholder","\n color: var(--n-placeholder-color);\n ",[S("inner","\n max-width: 100%;\n overflow: hidden;\n ")]),F("base-selection-tags","\n cursor: pointer;\n outline: none;\n box-sizing: border-box;\n position: relative;\n z-index: auto;\n display: flex;\n padding: var(--n-padding-multiple);\n flex-wrap: wrap;\n align-items: center;\n width: 100%;\n vertical-align: bottom;\n background-color: var(--n-color);\n border-radius: inherit;\n transition:\n color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n "),F("base-selection-label","\n height: var(--n-height);\n display: inline-flex;\n width: 100%;\n vertical-align: bottom;\n cursor: pointer;\n outline: none;\n z-index: auto;\n box-sizing: border-box;\n position: relative;\n transition:\n color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n border-radius: inherit;\n background-color: var(--n-color);\n align-items: center;\n ",[F("base-selection-input","\n font-size: inherit;\n line-height: inherit;\n outline: none;\n cursor: pointer;\n box-sizing: border-box;\n border:none;\n width: 100%;\n padding: var(--n-padding-single);\n background-color: #0000;\n color: var(--n-text-color);\n transition: color .3s var(--n-bezier);\n caret-color: var(--n-caret-color);\n ",[S("content","\n text-overflow: ellipsis;\n overflow: hidden;\n white-space: nowrap; \n ")]),S("render-label","\n color: var(--n-text-color);\n ")]),T("disabled",[O("&:hover",[S("state-border","\n box-shadow: var(--n-box-shadow-hover);\n border: var(--n-border-hover);\n ")]),R("focus",[S("state-border","\n box-shadow: var(--n-box-shadow-focus);\n border: var(--n-border-focus);\n ")]),R("active",[S("state-border","\n box-shadow: var(--n-box-shadow-active);\n border: var(--n-border-active);\n "),F("base-selection-label","background-color: var(--n-color-active);"),F("base-selection-tags","background-color: var(--n-color-active);")])]),R("disabled","cursor: not-allowed;",[S("arrow","\n color: var(--n-arrow-color-disabled);\n "),F("base-selection-label","\n cursor: not-allowed;\n background-color: var(--n-color-disabled);\n ",[F("base-selection-input","\n cursor: not-allowed;\n color: var(--n-text-color-disabled);\n "),S("render-label","\n color: var(--n-text-color-disabled);\n ")]),F("base-selection-tags","\n cursor: not-allowed;\n background-color: var(--n-color-disabled);\n "),F("base-selection-placeholder","\n cursor: not-allowed;\n color: var(--n-placeholder-color-disabled);\n ")]),F("base-selection-input-tag","\n height: calc(var(--n-height) - 6px);\n line-height: calc(var(--n-height) - 6px);\n outline: none;\n display: none;\n position: relative;\n margin-bottom: 3px;\n max-width: 100%;\n vertical-align: bottom;\n ",[S("input","\n font-size: inherit;\n font-family: inherit;\n min-width: 1px;\n padding: 0;\n background-color: #0000;\n outline: none;\n border: none;\n max-width: 100%;\n overflow: hidden;\n width: 1em;\n line-height: inherit;\n cursor: pointer;\n color: var(--n-text-color);\n caret-color: var(--n-caret-color);\n "),S("mirror","\n position: absolute;\n left: 0;\n top: 0;\n white-space: pre;\n visibility: hidden;\n user-select: none;\n -webkit-user-select: none;\n opacity: 0;\n ")]),["warning","error"].map((e=>R(`${e}-status`,[S("state-border",`border: var(--n-border-${e});`),T("disabled",[O("&:hover",[S("state-border",`\n box-shadow: var(--n-box-shadow-hover-${e});\n border: var(--n-border-hover-${e});\n `)]),R("active",[S("state-border",`\n box-shadow: var(--n-box-shadow-active-${e});\n border: var(--n-border-active-${e});\n `),F("base-selection-label",`background-color: var(--n-color-active-${e});`),F("base-selection-tags",`background-color: var(--n-color-active-${e});`)]),R("focus",[S("state-border",`\n box-shadow: var(--n-box-shadow-focus-${e});\n border: var(--n-border-focus-${e});\n `)])])])))]),F("base-selection-popover","\n margin-bottom: -3px;\n display: flex;\n flex-wrap: wrap;\n margin-right: -8px;\n "),F("base-selection-tag-wrapper","\n max-width: 100%;\n display: inline-flex;\n padding: 0 7px 3px 0;\n ",[O("&:last-child","padding-right: 0;"),F("tag","\n font-size: 14px;\n max-width: 100%;\n ",[S("content","\n line-height: 1.25;\n text-overflow: ellipsis;\n overflow: hidden;\n ")])])]),We=l({name:"InternalSelection",props:Object.assign(Object.assign({},z.props),{clsPrefix:{type:String,required:!0},bordered:{type:Boolean,default:void 0},active:Boolean,pattern:{type:String,default:""},placeholder:String,selectedOption:{type:Object,default:null},selectedOptions:{type:Array,default:null},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},multiple:Boolean,filterable:Boolean,clearable:Boolean,disabled:Boolean,size:{type:String,default:"medium"},loading:Boolean,autofocus:Boolean,showArrow:{type:Boolean,default:!0},inputProps:Object,focused:Boolean,renderTag:Function,onKeydown:Function,onClick:Function,onBlur:Function,onFocus:Function,onDeleteOption:Function,maxTagCount:[String,Number],onClear:Function,onPatternInput:Function,onPatternFocus:Function,onPatternBlur:Function,renderLabel:Function,status:String,inlineThemeDisabled:Boolean,ignoreComposition:{type:Boolean,default:!0},onResize:Function}),setup(t){const o=e(null),l=e(null),i=e(null),r=e(null),s=e(null),u=e(null),c=e(null),h=e(null),p=e(null),v=e(null),f=e(!1),g=e(!1),m=e(!1),w=z("InternalSelection","-internal-selection",Ne,le,t,d(t,"clsPrefix")),x=n((()=>t.clearable&&!t.disabled&&(m.value||t.active))),C=n((()=>t.selectedOption?t.renderTag?t.renderTag({option:t.selectedOption,handleClose:()=>{}}):t.renderLabel?t.renderLabel(t.selectedOption,!0):y(t.selectedOption[t.labelField],t.selectedOption,!0):t.placeholder)),F=n((()=>{const e=t.selectedOption;if(e)return e[t.labelField]})),S=n((()=>t.multiple?!(!Array.isArray(t.selectedOptions)||!t.selectedOptions.length):null!==t.selectedOption));function R(){var e;const{value:n}=o;if(n){const{value:o}=l;o&&(o.style.width=`${n.offsetWidth}px`,"responsive"!==t.maxTagCount&&(null===(e=p.value)||void 0===e||e.sync()))}}function O(e){const{onPatternInput:n}=t;n&&n(e)}function T(e){!function(e){const{onDeleteOption:n}=t;n&&n(e)}(e)}M(d(t,"active"),(e=>{e||function(){const{value:e}=v;e&&(e.style.display="none")}()})),M(d(t,"pattern"),(()=>{t.multiple&&b(R)}));const k=e(!1);let B=null;let $=null;function A(){null!==$&&window.clearTimeout($)}M(S,(e=>{e||(f.value=!1)})),a((()=>{D((()=>{const e=u.value;e&&(e.tabIndex=t.disabled||g.value?-1:0)}))})),Be(i,t.onResize);const{inlineThemeDisabled:L}=t,E=n((()=>{const{size:e}=t,{common:{cubicBezierEaseInOut:n},self:{borderRadius:o,color:l,placeholderColor:i,textColor:r,paddingSingle:a,paddingMultiple:s,caretColor:u,colorDisabled:d,textColorDisabled:c,placeholderColorDisabled:h,colorActive:p,boxShadowFocus:v,boxShadowActive:f,boxShadowHover:b,border:g,borderFocus:m,borderHover:y,borderActive:x,arrowColor:C,arrowColorDisabled:F,loadingColor:S,colorActiveWarning:R,boxShadowFocusWarning:O,boxShadowActiveWarning:T,boxShadowHoverWarning:k,borderWarning:z,borderFocusWarning:M,borderHoverWarning:B,borderActiveWarning:I,colorActiveError:$,boxShadowFocusError:A,boxShadowActiveError:L,boxShadowHoverError:E,borderError:D,borderFocusError:N,borderHoverError:W,borderActiveError:j,clearColor:_,clearColorHover:K,clearColorPressed:V,clearSize:H,arrowSize:U,[P("height",e)]:q,[P("fontSize",e)]:G}}=w.value;return{"--n-bezier":n,"--n-border":g,"--n-border-active":x,"--n-border-focus":m,"--n-border-hover":y,"--n-border-radius":o,"--n-box-shadow-active":f,"--n-box-shadow-focus":v,"--n-box-shadow-hover":b,"--n-caret-color":u,"--n-color":l,"--n-color-active":p,"--n-color-disabled":d,"--n-font-size":G,"--n-height":q,"--n-padding-single":a,"--n-padding-multiple":s,"--n-placeholder-color":i,"--n-placeholder-color-disabled":h,"--n-text-color":r,"--n-text-color-disabled":c,"--n-arrow-color":C,"--n-arrow-color-disabled":F,"--n-loading-color":S,"--n-color-active-warning":R,"--n-box-shadow-focus-warning":O,"--n-box-shadow-active-warning":T,"--n-box-shadow-hover-warning":k,"--n-border-warning":z,"--n-border-focus-warning":M,"--n-border-hover-warning":B,"--n-border-active-warning":I,"--n-color-active-error":$,"--n-box-shadow-focus-error":A,"--n-box-shadow-active-error":L,"--n-box-shadow-hover-error":E,"--n-border-error":D,"--n-border-focus-error":N,"--n-border-hover-error":W,"--n-border-active-error":j,"--n-clear-size":H,"--n-clear-color":_,"--n-clear-color-hover":K,"--n-clear-color-pressed":V,"--n-arrow-size":U}})),N=L?I("internal-selection",n((()=>t.size[0])),E,t):void 0;return{mergedTheme:w,mergedClearable:x,patternInputFocused:g,filterablePlaceholder:C,label:F,selected:S,showTagsPanel:f,isComposing:k,counterRef:c,counterWrapperRef:h,patternInputMirrorRef:o,patternInputRef:l,selfRef:i,multipleElRef:r,singleElRef:s,patternInputWrapperRef:u,overflowRef:p,inputTagElRef:v,handleMouseDown:function(e){t.active&&t.filterable&&e.target!==l.value&&e.preventDefault()},handleFocusin:function(e){var n;e.relatedTarget&&(null===(n=i.value)||void 0===n?void 0:n.contains(e.relatedTarget))||function(e){const{onFocus:n}=t;n&&n(e)}(e)},handleClear:function(e){!function(e){const{onClear:n}=t;n&&n(e)}(e)},handleMouseEnter:function(){m.value=!0},handleMouseLeave:function(){m.value=!1},handleDeleteOption:T,handlePatternKeyDown:function(e){if("Backspace"===e.key&&!k.value&&!t.pattern.length){const{selectedOptions:e}=t;(null==e?void 0:e.length)&&T(e[e.length-1])}},handlePatternInputInput:function(e){const{value:n}=o;if(n){const t=e.target.value;n.textContent=t,R()}t.ignoreComposition&&k.value?B=e:O(e)},handlePatternInputBlur:function(e){var n;g.value=!1,null===(n=t.onPatternBlur)||void 0===n||n.call(t,e)},handlePatternInputFocus:function(e){var n;g.value=!0,null===(n=t.onPatternFocus)||void 0===n||n.call(t,e)},handleMouseEnterCounter:function(){t.disabled||t.active||(A(),$=window.setTimeout((()=>{S.value&&(f.value=!0)}),100))},handleMouseLeaveCounter:function(){A()},handleFocusout:function(e){var n;(null===(n=i.value)||void 0===n?void 0:n.contains(e.relatedTarget))||function(e){const{onBlur:n}=t;n&&n(e)}(e)},handleCompositionEnd:function(){k.value=!1,t.ignoreComposition&&O(B),B=null},handleCompositionStart:function(){k.value=!0},onPopoverUpdateShow:function(e){e||(A(),f.value=!1)},focus:function(){var e,n,o;t.filterable?(g.value=!1,null===(e=u.value)||void 0===e||e.focus()):t.multiple?null===(n=r.value)||void 0===n||n.focus():null===(o=s.value)||void 0===o||o.focus()},focusInput:function(){const{value:e}=l;e&&(!function(){const{value:e}=v;e&&(e.style.display="inline-block")}(),e.focus())},blur:function(){var e,n;if(t.filterable)g.value=!1,null===(e=u.value)||void 0===e||e.blur(),null===(n=l.value)||void 0===n||n.blur();else if(t.multiple){const{value:e}=r;null==e||e.blur()}else{const{value:e}=s;null==e||e.blur()}},blurInput:function(){const{value:e}=l;e&&e.blur()},updateCounter:function(e){const{value:n}=c;n&&n.setTextContent(`+${e}`)},getCounter:function(){const{value:e}=h;return e},getTail:function(){return l.value},renderLabel:t.renderLabel,cssVars:L?void 0:E,themeClass:null==N?void 0:N.themeClass,onRender:null==N?void 0:N.onRender}},render(){const{status:e,multiple:n,size:t,disabled:o,filterable:l,maxTagCount:i,bordered:r,clsPrefix:a,onRender:s,renderTag:u,renderLabel:d}=this;null==s||s();const c="responsive"===i,h="number"==typeof i,v=c||h,f=p(W,null,{default:()=>p(ee,{clsPrefix:a,loading:this.loading,showArrow:this.showArrow,showClear:this.mergedClearable&&this.selected,onClear:this.handleClear},{default:()=>{var e,n;return null===(n=(e=this.$slots).arrow)||void 0===n?void 0:n.call(e)}})});let b;if(n){const{labelField:e}=this,n=n=>p("div",{class:`${a}-base-selection-tag-wrapper`,key:n.value},u?u({option:n,handleClose:()=>{this.handleDeleteOption(n)}}):p(re,{size:t,closable:!n.disabled,disabled:o,onClose:()=>{this.handleDeleteOption(n)},internalCloseIsButtonTag:!1,internalCloseFocusable:!1},{default:()=>d?d(n,!0):y(n[e],n,!0)})),r=()=>(h?this.selectedOptions.slice(0,i):this.selectedOptions).map(n),s=l?p("div",{class:`${a}-base-selection-input-tag`,ref:"inputTagElRef",key:"__input-tag__"},p("input",Object.assign({},this.inputProps,{ref:"patternInputRef",tabindex:-1,disabled:o,value:this.pattern,autofocus:this.autofocus,class:`${a}-base-selection-input-tag__input`,onBlur:this.handlePatternInputBlur,onFocus:this.handlePatternInputFocus,onKeydown:this.handlePatternKeyDown,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),p("span",{ref:"patternInputMirrorRef",class:`${a}-base-selection-input-tag__mirror`},this.pattern)):null,g=c?()=>p("div",{class:`${a}-base-selection-tag-wrapper`,ref:"counterWrapperRef"},p(re,{size:t,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,onMouseleave:this.handleMouseLeaveCounter,disabled:o})):void 0;let m;if(h){const e=this.selectedOptions.length-i;e>0&&(m=p("div",{class:`${a}-base-selection-tag-wrapper`,key:"__counter__"},p(re,{size:t,ref:"counterRef",onMouseenter:this.handleMouseEnterCounter,disabled:o},{default:()=>`+${e}`})))}const w=c?l?p(Pe,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,getTail:this.getTail,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:r,counter:g,tail:()=>s}):p(Pe,{ref:"overflowRef",updateCounter:this.updateCounter,getCounter:this.getCounter,style:{width:"100%",display:"flex",overflow:"hidden"}},{default:r,counter:g}):h?r().concat(m):r(),x=v?()=>p("div",{class:`${a}-base-selection-popover`},c?r():this.selectedOptions.map(n)):void 0,C=v?{show:this.showTagsPanel,trigger:"hover",overlap:!0,placement:"top",width:"trigger",onUpdateShow:this.onPopoverUpdateShow,theme:this.mergedTheme.peers.Popover,themeOverrides:this.mergedTheme.peerOverrides.Popover}:null,F=!this.selected&&(!this.active||!this.pattern&&!this.isComposing)?p("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`},p("div",{class:`${a}-base-selection-placeholder__inner`},this.placeholder)):null,S=l?p("div",{ref:"patternInputWrapperRef",class:`${a}-base-selection-tags`},w,c?null:s,f):p("div",{ref:"multipleElRef",class:`${a}-base-selection-tags`,tabindex:o?void 0:0},w,f);b=p(N,null,v?p(ue,Object.assign({},C,{scrollable:!0,style:"max-height: calc(var(--v-target-height) * 6.6);"}),{trigger:()=>S,default:x}):S,F)}else if(l){const e=this.pattern||this.isComposing,n=this.active?!e:!this.selected,t=!this.active&&this.selected;b=p("div",{ref:"patternInputWrapperRef",class:`${a}-base-selection-label`},p("input",Object.assign({},this.inputProps,{ref:"patternInputRef",class:`${a}-base-selection-input`,value:this.active?this.pattern:"",placeholder:"",readonly:o,disabled:o,tabindex:-1,autofocus:this.autofocus,onFocus:this.handlePatternInputFocus,onBlur:this.handlePatternInputBlur,onInput:this.handlePatternInputInput,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd})),t?p("div",{class:`${a}-base-selection-label__render-label ${a}-base-selection-overlay`,key:"input"},p("div",{class:`${a}-base-selection-overlay__wrapper`},u?u({option:this.selectedOption,handleClose:()=>{}}):d?d(this.selectedOption,!0):y(this.label,this.selectedOption,!0))):null,n?p("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`,key:"placeholder"},p("div",{class:`${a}-base-selection-overlay__wrapper`},this.filterablePlaceholder)):null,f)}else b=p("div",{ref:"singleElRef",class:`${a}-base-selection-label`,tabindex:this.disabled?void 0:0},void 0!==this.label?p("div",{class:`${a}-base-selection-input`,title:me(this.label),key:"input"},p("div",{class:`${a}-base-selection-input__content`},u?u({option:this.selectedOption,handleClose:()=>{}}):d?d(this.selectedOption,!0):y(this.label,this.selectedOption,!0))):p("div",{class:`${a}-base-selection-placeholder ${a}-base-selection-overlay`,key:"placeholder"},p("div",{class:`${a}-base-selection-placeholder__inner`},this.placeholder)),f);return p("div",{ref:"selfRef",class:[`${a}-base-selection`,this.themeClass,e&&`${a}-base-selection--${e}-status`,{[`${a}-base-selection--active`]:this.active,[`${a}-base-selection--selected`]:this.selected||this.active&&this.pattern,[`${a}-base-selection--disabled`]:this.disabled,[`${a}-base-selection--multiple`]:this.multiple,[`${a}-base-selection--focus`]:this.focused}],style:this.cssVars,onClick:this.onClick,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onKeydown:this.onKeydown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onMousedown:this.handleMouseDown},b,r?p("div",{class:`${a}-base-selection__border`}):null,r?p("div",{class:`${a}-base-selection__state-border`}):null)}});function je(e){return"group"===e.type}function _e(e){return"ignored"===e.type}function Ke(e,n){try{return!!(1+n.toString().toLowerCase().indexOf(e.trim().toLowerCase()))}catch(t){return!1}}function Ve(e,n){return{getIsGroup:je,getIgnored:_e,getKey:n=>je(n)?n.name||n.key||"key-required":n[e],getChildren:e=>e[n]}}const He=O([F("select","\n z-index: auto;\n outline: none;\n width: 100%;\n position: relative;\n "),F("select-menu","\n margin: 4px 0;\n box-shadow: var(--n-menu-box-shadow);\n ",[k({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),Ue=l({name:"Select",props:Object.assign(Object.assign({},z.props),{to:he.propTo,bordered:{type:Boolean,default:void 0},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},defaultValue:{type:[String,Number,Array],default:null},keyboard:{type:Boolean,default:!0},value:[String,Number,Array],placeholder:String,menuProps:Object,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},remote:Boolean,loading:Boolean,filter:Function,placement:{type:String,default:"bottom-start"},widthMode:{type:String,default:"trigger"},tag:Boolean,onCreate:Function,fallbackOption:{type:[Function,Boolean],default:void 0},show:{type:Boolean,default:void 0},showArrow:{type:Boolean,default:!0},maxTagCount:[Number,String],consistentMenuWidth:{type:Boolean,default:!0},virtualScroll:{type:Boolean,default:!0},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},childrenField:{type:String,default:"children"},renderLabel:Function,renderOption:Function,renderTag:Function,"onUpdate:value":[Function,Array],inputProps:Object,nodeProps:Function,ignoreComposition:{type:Boolean,default:!0},showOnFocus:Boolean,onUpdateValue:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onScroll:[Function,Array],onSearch:[Function,Array],onUpdateShow:[Function,Array],"onUpdate:show":[Function,Array],displayDirective:{type:String,default:"show"},resetMenuOnOptionsChange:{type:Boolean,default:!0},status:String,showCheckmark:{type:Boolean,default:!0},onChange:[Function,Array],items:Array}),setup(t){const{mergedClsPrefixRef:o,mergedBorderedRef:l,namespaceRef:i,inlineThemeDisabled:r}=j(t),a=z("Select","-select",He,ie,t,o),s=e(t.defaultValue),u=d(t,"value"),c=X(u,s),h=e(!1),p=e(""),v=n((()=>{const{valueField:e,childrenField:n}=t,o=Ve(e,n);return Z($.value,o)})),f=n((()=>function(e,n,t){const o=new Map;return e.forEach((e=>{je(e)?e[t].forEach((e=>{o.set(e[n],e)})):o.set(e[n],e)})),o}(P.value,t.valueField,t.childrenField))),b=e(!1),g=X(d(t,"show"),b),m=e(null),w=e(null),y=e(null),{localeRef:x}=ne("Select"),C=n((()=>{var e;return null!==(e=t.placeholder)&&void 0!==e?e:x.value.placeholder})),F=te(t,["items","options"]),S=[],R=e([]),O=e([]),T=e(new Map),k=n((()=>{const{fallbackOption:e}=t;if(void 0===e){const{labelField:e,valueField:n}=t;return t=>({[e]:String(t),[n]:t})}return!1!==e&&(n=>Object.assign(e(n),{value:n}))})),P=n((()=>O.value.concat(R.value).concat(F.value))),B=n((()=>{const{filter:e}=t;if(e)return e;const{labelField:n,valueField:o}=t;return(e,t)=>{if(!t)return!1;const l=t[n];if("string"==typeof l)return Ke(e,l);const i=t[o];return"string"==typeof i?Ke(e,i):"number"==typeof i&&Ke(e,String(i))}})),$=n((()=>{if(t.remote)return F.value;{const{value:e}=P,{value:n}=p;return n.length&&t.filterable?function(e,n,t,o){return n?function e(l){if(!Array.isArray(l))return[];const i=[];for(const r of l)if(je(r)){const n=e(r[o]);n.length&&i.push(Object.assign({},r,{[o]:n}))}else{if(_e(r))continue;n(t,r)&&i.push(r)}return i}(e):e}(e,B.value,n,t.childrenField):e}}));function A(e){const n=t.remote,{value:o}=T,{value:l}=f,{value:i}=k,r=[];return e.forEach((e=>{if(l.has(e))r.push(l.get(e));else if(n&&o.has(e))r.push(o.get(e));else if(i){const n=i(e);n&&r.push(n)}})),r}const L=n((()=>{if(t.multiple){const{value:e}=c;return Array.isArray(e)?A(e):[]}return null})),E=n((()=>{const{value:e}=c;return t.multiple||Array.isArray(e)||null===e?null:A([e])[0]||null})),D=_(t),{mergedSizeRef:N,mergedDisabledRef:W,mergedStatusRef:V}=D;function H(e,n){const{onChange:o,"onUpdate:value":l,onUpdateValue:i}=t,{nTriggerFormChange:r,nTriggerFormInput:a}=D;o&&Y(o,e,n),i&&Y(i,e,n),l&&Y(l,e,n),s.value=e,r(),a()}function U(e){const{onBlur:n}=t,{nTriggerFormBlur:o}=D;n&&Y(n,e),o()}function J(){var e;const{remote:n,multiple:o}=t;if(n){const{value:n}=T;if(o){const{valueField:o}=t;null===(e=L.value)||void 0===e||e.forEach((e=>{n.set(e[o],e)}))}else{const e=E.value;e&&n.set(e[t.valueField],e)}}}function ee(e){const{onUpdateShow:n,"onUpdate:show":o}=t;n&&Y(n,e),o&&Y(o,e),b.value=e}function oe(){W.value||(ee(!0),b.value=!0,t.filterable&&ve())}function le(){ee(!1)}function re(){p.value="",O.value=S}const ae=e(!1);function se(e){ue(e.rawNode)}function ue(e){if(W.value)return;const{tag:n,remote:o,clearFilterAfterSelect:l,valueField:i}=t;if(n&&!o){const{value:e}=O,n=e[0]||null;if(n){const e=R.value;e.length?e.push(n):R.value=[n],O.value=S}}if(o&&T.value.set(e[i],e),t.multiple){const r=function(e){if(!Array.isArray(e))return[];if(k.value)return Array.from(e);{const{remote:n}=t,{value:o}=f;if(n){const{value:n}=T;return e.filter((e=>o.has(e)||n.has(e)))}return e.filter((e=>o.has(e)))}}(c.value),a=r.findIndex((n=>n===e[i]));if(~a){if(r.splice(a,1),n&&!o){const n=de(e[i]);~n&&(R.value.splice(n,1),l&&(p.value=""))}}else r.push(e[i]),l&&(p.value="");H(r,A(r))}else{if(n&&!o){const n=de(e[i]);R.value=~n?[R.value[n]]:S}pe(),le(),H(e[i],e)}}function de(e){return R.value.findIndex((n=>n[t.valueField]===e))}function ce(e){var n,o,l,i,r;if(t.keyboard)switch(e.key){case" ":if(t.filterable)break;e.preventDefault();case"Enter":if(!(null===(n=m.value)||void 0===n?void 0:n.isComposing))if(g.value){const e=null===(o=y.value)||void 0===o?void 0:o.getPendingTmNode();e?se(e):t.filterable||(le(),pe())}else if(oe(),t.tag&&ae.value){const e=O.value[0];if(e){const n=e[t.valueField],{value:o}=c;t.multiple&&Array.isArray(o)&&o.some((e=>e===n))||ue(e)}}e.preventDefault();break;case"ArrowUp":if(e.preventDefault(),t.loading)return;g.value&&(null===(l=y.value)||void 0===l||l.prev());break;case"ArrowDown":if(e.preventDefault(),t.loading)return;g.value?null===(i=y.value)||void 0===i||i.next():oe();break;case"Escape":g.value&&(G(e),le()),null===(r=m.value)||void 0===r||r.focus()}else e.preventDefault()}function pe(){var e;null===(e=m.value)||void 0===e||e.focus()}function ve(){var e;null===(e=m.value)||void 0===e||e.focusInput()}J(),M(d(t,"options"),J);const fe={focus:()=>{var e;null===(e=m.value)||void 0===e||e.focus()},blur:()=>{var e;null===(e=m.value)||void 0===e||e.blur()}},be=n((()=>{const{self:{menuBoxShadow:e}}=a.value;return{"--n-menu-box-shadow":e}})),ge=r?I("select",void 0,be,t):void 0;return Object.assign(Object.assign({},fe),{mergedStatus:V,mergedClsPrefix:o,mergedBordered:l,namespace:i,treeMate:v,isMounted:K(),triggerRef:m,menuRef:y,pattern:p,uncontrolledShow:b,mergedShow:g,adjustedTo:he(t),uncontrolledValue:s,mergedValue:c,followerRef:w,localizedPlaceholder:C,selectedOption:E,selectedOptions:L,mergedSize:N,mergedDisabled:W,focused:h,activeWithoutMenuOpen:ae,inlineThemeDisabled:r,onTriggerInputFocus:function(){t.filterable&&(ae.value=!0)},onTriggerInputBlur:function(){t.filterable&&(ae.value=!1,g.value||re())},handleTriggerOrMenuResize:function(){var e;g.value&&(null===(e=w.value)||void 0===e||e.syncPosition())},handleMenuFocus:function(e){h.value=!0},handleMenuBlur:function(e){var n;(null===(n=m.value)||void 0===n?void 0:n.$el.contains(e.relatedTarget))||(h.value=!1,U(e),le())},handleMenuTabOut:function(){var e;null===(e=m.value)||void 0===e||e.focus(),le()},handleTriggerClick:function(){W.value||(g.value?t.filterable?ve():le():oe())},handleToggle:se,handleDeleteOption:ue,handlePatternInput:function(e){g.value||oe();const{value:n}=e.target;p.value=n;const{tag:o,remote:l}=t;if(function(e){const{onSearch:n}=t;n&&Y(n,e)}(n),o&&!l){if(!n)return void(O.value=S);const{onCreate:e}=t,o=e?e(n):{[t.labelField]:n,[t.valueField]:n},{valueField:l}=t;F.value.some((e=>e[l]===o[l]))||R.value.some((e=>e[l]===o[l]))?O.value=S:O.value=[o]}},handleClear:function(e){e.stopPropagation();const{multiple:n}=t;!n&&t.filterable&&le(),function(){const{onClear:e}=t;e&&Y(e)}(),n?H([],[]):H(null,null)},handleTriggerBlur:function(e){var n,t;(null===(t=null===(n=y.value)||void 0===n?void 0:n.selfRef)||void 0===t?void 0:t.contains(e.relatedTarget))||(h.value=!1,U(e),le())},handleTriggerFocus:function(e){!function(e){const{onFocus:n,showOnFocus:o}=t,{nTriggerFormFocus:l}=D;n&&Y(n,e),l(),o&&oe()}(e),h.value=!0},handleKeydown:ce,handleMenuAfterLeave:re,handleMenuClickOutside:function(e){var n;g.value&&((null===(n=m.value)||void 0===n?void 0:n.$el.contains(q(e)))||le())},handleMenuScroll:function(e){!function(e){const{onScroll:n}=t;n&&Y(n,e)}(e)},handleMenuKeydown:ce,handleMenuMousedown:function(e){Q(e,"action")||Q(e,"empty")||e.preventDefault()},mergedTheme:a,cssVars:r?void 0:be,themeClass:null==ge?void 0:ge.themeClass,onRender:null==ge?void 0:ge.onRender})},render(){return p("div",{class:`${this.mergedClsPrefix}-select`},p(pe,null,{default:()=>[p(ve,null,{default:()=>p(We,{ref:"triggerRef",inlineThemeDisabled:this.inlineThemeDisabled,status:this.mergedStatus,inputProps:this.inputProps,clsPrefix:this.mergedClsPrefix,showArrow:this.showArrow,maxTagCount:this.maxTagCount,bordered:this.mergedBordered,active:this.activeWithoutMenuOpen||this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,renderTag:this.renderTag,renderLabel:this.renderLabel,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,labelField:this.labelField,valueField:this.valueField,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,loading:this.loading,focused:this.focused,onClick:this.handleTriggerClick,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onBlur:this.handleTriggerBlur,onFocus:this.handleTriggerFocus,onKeydown:this.handleKeydown,onPatternBlur:this.onTriggerInputBlur,onPatternFocus:this.onTriggerInputFocus,onResize:this.handleTriggerOrMenuResize,ignoreComposition:this.ignoreComposition},{arrow:()=>{var e,n;return[null===(n=(e=this.$slots).arrow)||void 0===n?void 0:n.call(e)]}})}),p(fe,{ref:"followerRef",show:this.mergedShow,to:this.adjustedTo,teleportDisabled:this.adjustedTo===he.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target",placement:this.placement},{default:()=>p(C,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterLeave:this.handleMenuAfterLeave},{default:()=>{var e,n,t;return this.mergedShow||"show"===this.displayDirective?(null===(e=this.onRender)||void 0===e||e.call(this),V(p(De,Object.assign({},this.menuProps,{ref:"menuRef",onResize:this.handleTriggerOrMenuResize,inlineThemeDisabled:this.inlineThemeDisabled,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,class:[`${this.mergedClsPrefix}-select-menu`,this.themeClass,null===(n=this.menuProps)||void 0===n?void 0:n.class],clsPrefix:this.mergedClsPrefix,focusable:!0,labelField:this.labelField,valueField:this.valueField,autoPending:!0,nodeProps:this.nodeProps,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,treeMate:this.treeMate,multiple:this.multiple,size:"medium",renderOption:this.renderOption,renderLabel:this.renderLabel,value:this.mergedValue,style:[null===(t=this.menuProps)||void 0===t?void 0:t.style,this.cssVars],onToggle:this.handleToggle,onScroll:this.handleMenuScroll,onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onTabOut:this.handleMenuTabOut,onMousedown:this.handleMenuMousedown,show:this.mergedShow,showCheckmark:this.showCheckmark,resetMenuOnOptionsChange:this.resetMenuOnOptionsChange}),{empty:()=>{var e,n;return[null===(n=(e=this.$slots).empty)||void 0===n?void 0:n.call(e)]},action:()=>{var e,n;return[null===(n=(e=this.$slots).action)||void 0===n?void 0:n.call(e)]}}),"show"===this.displayDirective?[[H,this.mergedShow],[U,this.handleMenuClickOutside,void 0,{capture:!0}]]:[[U,this.handleMenuClickOutside,void 0,{capture:!0}]])):null}})})]}))}});export{De as N,ke as V,Ue as _,Ve as c,we as m};
