import{_ as e,cN as a,cB as s,cM as o,e as t,a8 as r,Y as l,f as i,o as u,c as m,d as p,a as n,w as c,u as d,t as g,q as j,c8 as v,dt as h,dj as f,du as y,g as C,cv as _,b as S,k as b,c4 as x}from"./index-c72c5b0c.js";import{D as $}from"./DataLists-aff5237d.js";import{P as k}from"./index-69256b9d.js";import{_ as w}from"./Popover-87b27d79.js";import{_ as D}from"./Progress-90277c5d.js";import{_ as F}from"./text-64fc9966.js";import{_ as N}from"./Space-5d75b1a8.js";import"./AllArtists-b2fee903.js";import"./AddPlaylist-fbffd947.js";import"./CreatePlaylist-a7b4fb4f.js";import"./Input-b4caa030.js";import"./Suffix-af55cfcd.js";import"./index-92eb66c0.js";import"./use-merged-state-74230ec8.js";import"./light-6c88686a.js";import"./Checkbox-edaaabdb.js";import"./light-c071e0c7.js";import"./Tag-827106b2.js";import"./_common-991711fd.js";import"./Avatar-62f97100.js";import"./utils-48198701.js";import"./light-4ec95d76.js";import"./SmallSongData-c72e9d99.js";import"./FormItem-e0127deb.js";import"./light-8d6c1748.js";import"./InputNumber-3459a9d0.js";import"./Add-b088e338.js";import"./Alert-e807b2ba.js";import"./_common-60fffae6.js";import"./Radio-3c9720cb.js";import"./RadioGroup-b4b538f1.js";import"./light-5b209fbc.js";import"./get-slot-a0e67e91.js";import"./RecordDisc-b91e091f.js";import"./LinkTwo-8d6bc0a2.js";import"./light-bf1b7eb7.js";import"./use-compitable-a1866e01.js";import"./PlayOne-22adba7e.js";import"./DeleteFour-7678c621.js";import"./Dropdown-db0b14d8.js";import"./create-07671515.js";import"./Follower-ef4b8179.js";import"./next-frame-once-924ab492.js";import"./cssr-ed8d5782.js";import"./light-37eaa122.js";import"./light-cb0cf260.js";import"./create-ref-setter-ee697025.js";import"./DrawerContent-eda0377e.js";import"./light-ae2f09ac.js";import"./Pagination-10257b2a.js";import"./Select-714380b7.js";import"./light-20fa43af.js";import"./light-170bfcda.js";import"./Empty-3e1da814.js";import"./light-e632ba41.js";import"./light-7a086192.js";import"./light-a7677734.js";import"./_common-89f2509f.js";const P={class:"cloud"},A={class:"data"},R={key:0,class:"space"},T=e({__name:"cloud",setup(e){const{t:T}=a(),q=s(),E=o(),I=t([]),z=t([]),U=t(30),G=t(q.currentRoute.value.query.page?Number(q.currentRoute.value.query.page):1),L=t(0),M=t(null),H=t("success"),B=t(!1),V=t(0),X=(e=30,a=0,s=!0)=>{h(e,a).then((e=>{L.value=e.count,z.value=[],I.value=[(e.size/Math.pow(1024,3)).toFixed(2),(e.maxSize/Math.pow(1024,3)).toFixed(0)],e.data?e.data.forEach(((e,a)=>{z.value.push({id:e.songId,num:a+1+(G.value-1)*U.value,name:e.simpleSong.name,artist:e.simpleSong.ar,album:e.simpleSong.al,alia:e.simpleSong.alia,mv:e.simpleSong.mv,time:f(e.simpleSong.dt)})})):$message.error(T("general.message.acquisitionFailed")),"undefined"!=typeof $scrollToTop&&$scrollToTop()}))},Y=e=>{const{loaded:a,total:s}=e,o=Math.round(100*a/s);V.value=Number(o)},Z=e=>{const a=e.target.files;if(!a[0])return!1;H.value="success",B.value=!0,y(a[0],Y).then((e=>{var a,s;200===e.code?(J(),(null==(a=e.privateCloud.simpleSong.al)?void 0:a.name)||$message.warning(T("general.message.upCloudNotHas")),$message.success(T("general.message.upCloudSuccess",{name:null==(s=e.privateCloud.simpleSong)?void 0:s.name})),X(U.value,(G.value-1)*U.value)):(H.value="error",$message.error(T("general.message.upCloudError")),console.error(T("general.message.upCloudError")))})).catch((e=>{H.value="error",J(),$message.error(T("general.message.upCloudFailure")),console.error(T("general.message.upCloudFailure"),e)}))},J=()=>{B.value=!1,V.value=0,M.value.value=null},K=()=>{J(),M.value.click()},O=e=>{U.value=e,X(e,(G.value-1)*U.value)},Q=e=>{q.push({path:"/music/user/cloud",query:{page:e}})};return r("cloudDataLoad",((e=!1)=>{X(U.value,(G.value-1)*U.value,e)})),l((()=>q.currentRoute.value),(e=>{G.value=Number(e.query.page?e.query.page:1),"user-cloud"==e.name&&X(U.value,(G.value-1)*U.value)})),i((()=>{$setSiteTitle(T("nav.user")+" - "+T("nav.userChildren.cloud")),X(U.value,(G.value-1)*U.value)})),(e,a)=>{const s=x,o=C,t=D,r=F,l=w,i=N,h=_;return u(),m("div",P,[p("div",A,[n(o,{class:"up",type:"primary",strong:"",secondary:"",round:"",onClick:a[0]||(a[0]=e=>d(M).click())},{icon:c((()=>[n(s,{component:"CloudDone"})])),default:c((()=>[S(" "+g(e.$t("general.name.upCloud")),1)])),_:1}),p("input",{ref_key:"upSongRef",ref:M,type:"file",style:{display:"none"},accept:"audio/*",onChange:Z},null,544),d(I)[0]?(u(),m("div",R,[p("span",null,g(d(I)[0])+" G",1),n(l,{trigger:"hover"},{trigger:c((()=>[n(t,{type:"line",color:d(E).themeData.primaryColor,class:"progress","show-indicator":!1,percentage:100/(d(I)[1]/d(I)[0])},null,8,["color","percentage"])])),default:c((()=>[n(r,null,{default:c((()=>[S(g(e.$t("general.name.cloudUsed",{used:(100/(d(I)[1]/d(I)[0])).toFixed(),remaining:d(I)[1]-d(I)[0]})),1)])),_:1})])),_:1}),p("span",null,g(d(I)[1])+" G",1)])):j("",!0)]),n($,{listData:d(z)},null,8,["listData"]),n(k,{totalCount:d(L),pageNumber:d(G),onPageSizeChange:O,onPageNumberChange:Q},null,8,["totalCount","pageNumber"]),n(h,{class:"s-modal close",show:d(B),"onUpdate:show":a[1]||(a[1]=e=>v(B)?B.value=e:null),preset:"card",title:e.$t("general.name.upCloud"),"auto-focus":!1,bordered:!1,"close-on-esc":!1,esc:!1,"mask-closable":!1},{footer:c((()=>["error"===d(H)?(u(),b(i,{key:0,justify:"end"},{default:c((()=>[n(o,{onClick:J},{default:c((()=>[S(g(e.$t("general.dialog.cancel")),1)])),_:1}),n(o,{type:"primary",onClick:K},{default:c((()=>[S(g(e.$t("general.dialog.resetUp")),1)])),_:1})])),_:1})):j("",!0)])),default:c((()=>[n(t,{type:"line",status:d(H),percentage:d(V),"indicator-placement":"inside",processing:""},null,8,["status","percentage"])])),_:1},8,["show","title"])])}}},[["__scopeId","data-v-9b14bd04"]]);export{T as default};
