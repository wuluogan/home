import{y as e,o as a,c as s,d as t,_ as o,d8 as r,cP as l,d7 as i,e as u,a8 as n,Y as m,f as p,a as c,w as g,u as d,t as v,q as j,ch as h,ef as f,e1 as y,eg as C,g as w,cJ as S,b as _,k as x,bO as b}from"./index-d93ecfd9.js";import{D as k}from"./DataLists-2d284e43.js";import{P as $}from"./index-e01b8113.js";import{_ as D}from"./Popover-92ca2497.js";import{_ as N}from"./Progress-6ebfbbb8.js";import{_ as P}from"./text-f881741e.js";import{_ as A}from"./Space-76cfe381.js";import"./AllArtists-e33e1687.js";import"./AddPlaylist-0e9ef9cc.js";import"./CreatePlaylist-db76e905.js";import"./Input-19ebdc3b.js";import"./Suffix-1fd55ec3.js";import"./index-92eb66c0.js";import"./use-merged-state-bb55b613.js";import"./light-1b9db3a7.js";import"./Checkbox-995e550a.js";import"./light-2c22dcb8.js";import"./Tag-9bd41f20.js";import"./_common-991711fd.js";import"./Avatar-d697b90d.js";import"./utils-5d91cb42.js";import"./light-d2124738.js";import"./SmallSongData-d7110d79.js";import"./FormItem-ccd063f6.js";import"./light-d411e82b.js";import"./InputNumber-43a45814.js";import"./Add-00122154.js";import"./Alert-a6104c4f.js";import"./_common-60fffae6.js";import"./Radio-24bd6234.js";import"./RadioGroup-cb180d59.js";import"./light-ca51619b.js";import"./get-slot-a0e67e91.js";import"./Dropdown-ca523edc.js";import"./create-07671515.js";import"./Follower-829f72e1.js";import"./next-frame-once-924ab492.js";import"./cssr-2139d5e3.js";import"./light-5ced6f1c.js";import"./light-f76c98be.js";import"./create-ref-setter-ee697025.js";import"./DrawerContent-b50dea9b.js";import"./light-51fd1fd4.js";import"./Spin-c12f3861.js";import"./light-f8d78f18.js";import"./use-compitable-f583eb1a.js";import"./Pagination-eed167c0.js";import"./Select-d00ca0af.js";import"./light-25af1eec.js";import"./light-16e65505.js";import"./Empty-d19cae85.js";import"./light-f5dc26c8.js";import"./light-5da1e5bf.js";import"./light-6dc1ea6d.js";import"./_common-89f2509f.js";const F={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},R=[t("path",{d:"M19 11c0-3.87-3.13-7-7-7a6.99 6.99 0 0 0-6.74 5.15A5.49 5.49 0 0 0 1 14.5C1 17.54 3.46 20 6.5 20h12c2.49-.01 4.5-2.03 4.5-4.52c0-2.33-1.75-4.22-4-4.48zm-6 2v2c0 .55-.45 1-1 1s-1-.45-1-1v-2H9.21c-.45 0-.67-.54-.35-.85l2.79-2.79c.2-.2.51-.2.71 0l2.79 2.79a.5.5 0 0 1-.35.85H13z",fill:"currentColor"},null,-1)],q=e({name:"BackupRound",render:function(e,t){return a(),s("svg",F,R)}}),I={class:"cloud"},z={class:"data"},T={key:0,class:"space"},E=o({__name:"cloud",setup(e){const{t:o}=r(),F=l(),R=i(),E=u([]),U=u([]),G=u(30),H=u(F.currentRoute.value.query.page?Number(F.currentRoute.value.query.page):1),M=u(0),B=u(null),L=u("success"),O=u(!1),Y=u(0),J=(e=30,a=0,s=!0)=>{f(e,a).then((e=>{M.value=e.count,U.value=[],E.value=[(e.size/Math.pow(1024,3)).toFixed(2),(e.maxSize/Math.pow(1024,3)).toFixed(0)],e.data?e.data.forEach(((e,a)=>{U.value.push({id:e.songId,num:a+1+(H.value-1)*G.value,name:e.simpleSong.name,artist:e.simpleSong.ar,album:e.simpleSong.al,alia:e.simpleSong.alia,mv:e.simpleSong.mv,time:y(e.simpleSong.dt)})})):$message.error(o("general.message.acquisitionFailed")),"undefined"!=typeof $scrollToTop&&$scrollToTop()}))},Q=e=>{const{loaded:a,total:s}=e,t=Math.round(100*a/s);Y.value=Number(t)},V=e=>{const a=e.target.files;if(!a[0])return!1;L.value="success",O.value=!0,C(a[0],Q).then((e=>{var a,s;200===e.code?(W(),(null==(a=e.privateCloud.simpleSong.al)?void 0:a.name)||$message.warning(o("general.message.upCloudNotHas")),$message.success(o("general.message.upCloudSuccess",{name:null==(s=e.privateCloud.simpleSong)?void 0:s.name})),J(G.value,(H.value-1)*G.value)):(L.value="error",$message.error(o("general.message.upCloudError")),console.error(o("general.message.upCloudError")))})).catch((e=>{L.value="error",W(),$message.error(o("general.message.upCloudFailure")),console.error(o("general.message.upCloudFailure"),e)}))},W=()=>{O.value=!1,Y.value=0,B.value.value=null},X=()=>{W(),B.value.click()},K=e=>{G.value=e,J(e,(H.value-1)*G.value)},Z=e=>{F.push({path:"/user/cloud",query:{page:e}})};return n("cloudDataLoad",((e=!1)=>{J(G.value,(H.value-1)*G.value,e)})),m((()=>F.currentRoute.value),(e=>{H.value=Number(e.query.page?e.query.page:1),"user-cloud"==e.name&&J(G.value,(H.value-1)*G.value)})),p((()=>{$setSiteTitle(o("nav.user")+" - "+o("nav.userChildren.cloud")),J(G.value,(H.value-1)*G.value)})),(e,o)=>{const r=b,l=w,i=N,u=P,n=D,m=A,p=S;return a(),s("div",I,[t("div",z,[c(l,{class:"up",type:"primary",strong:"",secondary:"",round:"",onClick:o[0]||(o[0]=e=>d(B).click())},{icon:g((()=>[c(r,{component:d(q)},null,8,["component"])])),default:g((()=>[_(" "+v(e.$t("general.name.upCloud")),1)])),_:1}),t("input",{ref_key:"upSongRef",ref:B,type:"file",style:{display:"none"},accept:"audio/*",onChange:V},null,544),d(E)[0]?(a(),s("div",T,[t("span",null,v(d(E)[0])+" G",1),c(n,{trigger:"hover"},{trigger:g((()=>[c(i,{type:"line",color:d(R).themeData.primaryColor,class:"progress","show-indicator":!1,percentage:100/(d(E)[1]/d(E)[0])},null,8,["color","percentage"])])),default:g((()=>[c(u,null,{default:g((()=>[_(v(e.$t("general.name.cloudUsed",{used:(100/(d(E)[1]/d(E)[0])).toFixed(),remaining:d(E)[1]-d(E)[0]})),1)])),_:1})])),_:1}),t("span",null,v(d(E)[1])+" G",1)])):j("",!0)]),c(k,{listData:d(U)},null,8,["listData"]),c($,{totalCount:d(M),pageNumber:d(H),onPageSizeChange:K,onPageNumberChange:Z},null,8,["totalCount","pageNumber"]),c(p,{class:"s-modal close",show:d(O),"onUpdate:show":o[1]||(o[1]=e=>h(O)?O.value=e:null),preset:"card",title:e.$t("general.name.upCloud"),"auto-focus":!1,bordered:!1,"close-on-esc":!1,esc:!1,"mask-closable":!1},{footer:g((()=>["error"===d(L)?(a(),x(m,{key:0,justify:"end"},{default:g((()=>[c(l,{onClick:W},{default:g((()=>[_(v(e.$t("general.dialog.cancel")),1)])),_:1}),c(l,{type:"primary",onClick:X},{default:g((()=>[_(v(e.$t("general.dialog.resetUp")),1)])),_:1})])),_:1})):j("",!0)])),default:g((()=>[c(i,{type:"line",status:d(L),percentage:d(Y),"indicator-placement":"inside",processing:""},null,8,["status","percentage"])])),_:1},8,["show","title"])])}}},[["__scopeId","data-v-8782fe65"]]);export{E as default};
