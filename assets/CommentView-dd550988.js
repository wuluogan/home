import{_ as e,cN as t,cB as a,cO as s,e as o,r as m,f as l,Y as n,o as r,c as i,a as u,w as p,ac as c,u as g,d,t as j,q as y,F as C,x as h,an as v,g as f,k,b as x,p as b,l as D}from"./index-c72c5b0c.js";import{g as _,C as S}from"./index-1b33abe7.js";import{S as $}from"./SmallSongData-c72e9d99.js";import{P as q}from"./index-69256b9d.js";import{a as P}from"./headers-9bed30c4.js";import{_ as w}from"./Skeleton-163a49d9.js";import"./text-64fc9966.js";import"./use-compitable-a1866e01.js";import"./light-a7677734.js";import"./AllArtists-b2fee903.js";import"./Avatar-62f97100.js";import"./utils-48198701.js";import"./Tag-827106b2.js";import"./_common-991711fd.js";import"./light-4ec95d76.js";import"./Pagination-10257b2a.js";import"./Suffix-af55cfcd.js";import"./index-92eb66c0.js";import"./use-merged-state-74230ec8.js";import"./Input-b4caa030.js";import"./light-6c88686a.js";import"./Select-714380b7.js";import"./create-07671515.js";import"./light-20fa43af.js";import"./light-cb0cf260.js";import"./light-170bfcda.js";import"./cssr-ed8d5782.js";import"./Popover-87b27d79.js";import"./Follower-ef4b8179.js";import"./next-frame-once-924ab492.js";import"./Empty-3e1da814.js";import"./light-e632ba41.js";import"./create-ref-setter-ee697025.js";import"./use-houdini-1a86f12f.js";const N={class:"comment"},T={key:0,class:"title"},R={class:"key"},B={key:1,class:"title"},A={class:"key"},F=(e=>(b("data-v-b90238a9"),e=e(),D(),e))((()=>d("br",null,null,-1))),I={key:2,class:"commentData"},V={key:0,class:"hotComments"},E={key:0,class:"loading"},O={class:"content"},Y={class:"allComments",ref:"allCommentsRef"},z={class:"count"},G={key:0,class:"loading"},H={class:"content"},J=e({__name:"CommentView",setup(e){const{t:b}=t(),D=a(),J=s(),K=o(D.currentRoute.value.query.id),L=o(D.currentRoute.value.query.page?Number(D.currentRoute.value.query.page):1),Q=m({hotComments:[],allComments:[]}),U=o(0),X=(e,t=0)=>{let a=null;Q.allComments[0]&&t>=5e3&&(a=Q.allComments[Q.allComments.length-1].time),_(e,t,a).then((e=>{e.comments&&e.comments[0]?(e.hotComments?Q.hotComments=e.hotComments:Q.hotComments=[],Q.allComments=e.comments,U.value=e.total):($message.error(b("general.message.acquisitionFailed")),D.go(-1)),"undefined"!=typeof $scrollToTop&&$scrollToTop()}))},Z=e=>{D.push({path:"/music/comment",query:{id:K.value,page:e}})};return l((()=>{$setSiteTitle(b("general.name.allComments")),K.value&&X(K.value,20*(L.value-1))})),n((()=>D.currentRoute.value),(e=>{L.value=Number(e.query.page?e.query.page:1),"comment"==e.name&&(K.value=e.query.id,X(e.query.id,20*(L.value-1)))})),(e,t)=>{const a=v,s=f,o=P,m=w;return r(),i("div",N,[u(c,{name:"up"},{default:p((()=>[g(J).getPlaySongData&&g(J).getPlaySongData.id!=g(K)?(r(),k(a,{key:0,class:"goback",onClick:t[0]||(t[0]=e=>g(D).push(`/music/comment?id=${g(J).getPlaySongData.id}&page=1`)),"content-style":"padding: 6px"},{default:p((()=>[x(j(e.$t("general.name.toCurrentlySong")),1)])),_:1})):y("",!0)])),_:1}),g(K)?(r(),i("div",T,[d("span",R,j(e.$t("general.name.allComments")),1),u(a,{class:"song"},{default:p((()=>[u($,{getDataByID:g(K)},null,8,["getDataByID"])])),_:1})])):(r(),i("div",B,[d("span",A,j(e.$t("general.name.noKeywords")),1),F,u(s,{strong:"",secondary:"",onClick:t[1]||(t[1]=e=>g(D).go(-1)),style:{"margin-top":"20px"}},{default:p((()=>[x(j(e.$t("general.name.goBack")),1)])),_:1})])),g(K)&&g(Q).allComments[0]?(r(),i("div",I,[g(Q).hotComments[0]?(r(),i("div",V,[u(o,{prefix:"bar"},{default:p((()=>[x(j(e.$t("general.name.hotComments")),1)])),_:1}),g(Q).hotComments[0]?y("",!0):(r(),i("div",E,[u(m,{text:"",repeat:3}),u(m,{text:"",style:{width:"60%"}})])),d("div",O,[(r(!0),i(C,null,h(g(Q).hotComments,(e=>(r(),k(S,{key:e,commentData:e},null,8,["commentData"])))),128))])])):y("",!0),d("div",Y,[u(o,{prefix:"bar"},{default:p((()=>[x(j(e.$t("general.name.allComments"))+" ",1),d("span",z,j(g(U))+" +",1)])),_:1}),g(Q).allComments[0]?y("",!0):(r(),i("div",G,[u(m,{text:"",repeat:3}),u(m,{text:"",style:{width:"60%"}})])),d("div",H,[(r(!0),i(C,null,h(g(Q).allComments,(e=>(r(),k(S,{key:e,commentData:e},null,8,["commentData"])))),128))])],512),u(q,{totalCount:g(U),pageNumber:g(L),showSizePicker:!1,onPageNumberChange:Z},null,8,["totalCount","pageNumber"])])):y("",!0)])}}},[["__scopeId","data-v-b90238a9"]]);export{J as default};
