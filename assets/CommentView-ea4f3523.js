import{_ as e,d8 as t,cP as a,d9 as s,e as o,r as m,f as l,Y as n,o as r,c as i,a as u,w as p,ac as c,u as g,d,t as j,q as y,F as C,x as f,an as h,g as v,k,b as x,p as b,l as D}from"./index-d93ecfd9.js";import{g as S,C as _}from"./index-eb769a5c.js";import{S as $}from"./SmallSongData-d7110d79.js";import{P as q}from"./index-e01b8113.js";import{a as P}from"./headers-79a1892a.js";import{_ as w}from"./Skeleton-8803bfe7.js";import"./text-f881741e.js";import"./use-compitable-f583eb1a.js";import"./light-6dc1ea6d.js";import"./AllArtists-e33e1687.js";import"./Avatar-d697b90d.js";import"./utils-5d91cb42.js";import"./Tag-9bd41f20.js";import"./_common-991711fd.js";import"./light-d2124738.js";import"./Pagination-eed167c0.js";import"./Suffix-1fd55ec3.js";import"./index-92eb66c0.js";import"./use-merged-state-bb55b613.js";import"./Input-19ebdc3b.js";import"./light-1b9db3a7.js";import"./Select-d00ca0af.js";import"./create-07671515.js";import"./light-25af1eec.js";import"./light-f76c98be.js";import"./light-16e65505.js";import"./cssr-2139d5e3.js";import"./Popover-92ca2497.js";import"./Follower-829f72e1.js";import"./next-frame-once-924ab492.js";import"./Empty-d19cae85.js";import"./light-f5dc26c8.js";import"./create-ref-setter-ee697025.js";import"./use-houdini-2a8f5bbb.js";const I={class:"comment"},N={key:0,class:"title"},R={class:"key"},T={key:1,class:"title"},A={class:"key"},B=(e=>(b("data-v-a3bf9ffe"),e=e(),D(),e))((()=>d("br",null,null,-1))),F={key:2,class:"commentData"},z={key:0,class:"hotComments"},E={key:0,class:"loading"},V={class:"content"},Y={class:"allComments",ref:"allCommentsRef"},G={class:"count"},J={key:0,class:"loading"},K={class:"content"},O=e({__name:"CommentView",setup(e){const{t:b}=t(),D=a(),O=s(),Q=o(D.currentRoute.value.query.id),U=o(D.currentRoute.value.query.page?Number(D.currentRoute.value.query.page):1),W=m({hotComments:[],allComments:[]}),X=o(0),Z=(e,t=0)=>{let a=null;W.allComments[0]&&t>=5e3&&(a=W.allComments[W.allComments.length-1].time),S(e,t,a).then((e=>{e.comments&&e.comments[0]?(e.hotComments?W.hotComments=e.hotComments:W.hotComments=[],W.allComments=e.comments,X.value=e.total):($message.error(b("general.message.acquisitionFailed")),D.go(-1)),"undefined"!=typeof $scrollToTop&&$scrollToTop()}))},H=e=>{D.push({path:"/comment",query:{id:Q.value,page:e}})};return l((()=>{$setSiteTitle(b("general.name.allComments")),Q.value&&Z(Q.value,20*(U.value-1))})),n((()=>D.currentRoute.value),(e=>{U.value=Number(e.query.page?e.query.page:1),"comment"==e.name&&(Q.value=e.query.id,Z(e.query.id,20*(U.value-1)))})),(e,t)=>{const a=h,s=v,o=P,m=w;return r(),i("div",I,[u(c,{name:"up"},{default:p((()=>[g(O).getPlaySongData&&g(O).getPlaySongData.id!=g(Q)?(r(),k(a,{key:0,class:"goback",onClick:t[0]||(t[0]=e=>g(D).push(`/comment?id=${g(O).getPlaySongData.id}&page=1`)),"content-style":"padding: 6px"},{default:p((()=>[x(j(e.$t("general.name.toCurrentlySong")),1)])),_:1})):y("",!0)])),_:1}),g(Q)?(r(),i("div",N,[d("span",R,j(e.$t("general.name.allComments")),1),u(a,{class:"song"},{default:p((()=>[u($,{getDataByID:g(Q)},null,8,["getDataByID"])])),_:1})])):(r(),i("div",T,[d("span",A,j(e.$t("general.name.noKeywords")),1),B,u(s,{strong:"",secondary:"",onClick:t[1]||(t[1]=e=>g(D).go(-1)),style:{"margin-top":"20px"}},{default:p((()=>[x(j(e.$t("general.name.goBack")),1)])),_:1})])),g(Q)&&g(W).allComments[0]?(r(),i("div",F,[g(W).hotComments[0]?(r(),i("div",z,[u(o,{prefix:"bar"},{default:p((()=>[x(j(e.$t("general.name.hotComments")),1)])),_:1}),g(W).hotComments[0]?y("",!0):(r(),i("div",E,[u(m,{text:"",repeat:3}),u(m,{text:"",style:{width:"60%"}})])),d("div",V,[(r(!0),i(C,null,f(g(W).hotComments,(e=>(r(),k(_,{key:e,commentData:e},null,8,["commentData"])))),128))])])):y("",!0),d("div",Y,[u(o,{prefix:"bar"},{default:p((()=>[x(j(e.$t("general.name.allComments"))+" ",1),d("span",G,j(g(X))+" +",1)])),_:1}),g(W).allComments[0]?y("",!0):(r(),i("div",J,[u(m,{text:"",repeat:3}),u(m,{text:"",style:{width:"60%"}})])),d("div",K,[(r(!0),i(C,null,f(g(W).allComments,(e=>(r(),k(_,{key:e,commentData:e},null,8,["commentData"])))),128))])],512),u(q,{totalCount:g(X),pageNumber:g(U),showSizePicker:!1,onPageNumberChange:H},null,8,["totalCount","pageNumber"])])):y("",!0)])}}},[["__scopeId","data-v-a3bf9ffe"]]);export{O as default};
