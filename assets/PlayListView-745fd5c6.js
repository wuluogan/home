import{c2 as e,a as s,_ as a,cN as t,cB as l,cQ as o,cO as i,cM as r,e as n,f as c,Y as m,u as p,o as u,c as d,d as g,w as h,t as v,k,q as j,c8 as y,z as f,dw as w,dx as L,dj as $,dh as b,di as C,g as _,cv as x,b as P,F as T,x as M,bO as S,de as U,p as q,l as D}from"./index-c72c5b0c.js";import{D as F,M as I}from"./DataLists-aff5237d.js";import{P as N}from"./index-69256b9d.js";import{g as H}from"./getCoverUrl-bb08aa65.js";import{M as z}from"./MusicList-4148cdec.js";import{P as A}from"./People-26086f57.js";import{L as E,a as R}from"./LinkTwo-8d6bc0a2.js";import{U as W}from"./Unlike-d603c2d2.js";import{_ as B}from"./Image-6ba3d672.js";import{_ as V}from"./Space-5d75b1a8.js";import{_ as O}from"./text-64fc9966.js";import{D as Q}from"./DeleteFour-7678c621.js";import{_ as X}from"./Tag-827106b2.js";import{_ as Z}from"./Dropdown-db0b14d8.js";import{_ as G}from"./Scrollbar-4274af02.js";import{_ as J}from"./Skeleton-163a49d9.js";import"./AllArtists-b2fee903.js";import"./AddPlaylist-fbffd947.js";import"./CreatePlaylist-a7b4fb4f.js";import"./Input-b4caa030.js";import"./Suffix-af55cfcd.js";import"./index-92eb66c0.js";import"./use-merged-state-74230ec8.js";import"./light-6c88686a.js";import"./Checkbox-edaaabdb.js";import"./light-c071e0c7.js";import"./Avatar-62f97100.js";import"./utils-48198701.js";import"./light-4ec95d76.js";import"./SmallSongData-c72e9d99.js";import"./FormItem-e0127deb.js";import"./light-8d6c1748.js";import"./Popover-87b27d79.js";import"./light-cb0cf260.js";import"./Follower-ef4b8179.js";import"./next-frame-once-924ab492.js";import"./cssr-ed8d5782.js";import"./use-compitable-a1866e01.js";import"./InputNumber-3459a9d0.js";import"./Add-b088e338.js";import"./Alert-e807b2ba.js";import"./_common-60fffae6.js";import"./Radio-3c9720cb.js";import"./RadioGroup-b4b538f1.js";import"./light-5b209fbc.js";import"./get-slot-a0e67e91.js";import"./RecordDisc-b91e091f.js";import"./PlayOne-22adba7e.js";import"./DrawerContent-eda0377e.js";import"./light-ae2f09ac.js";import"./Pagination-10257b2a.js";import"./Select-714380b7.js";import"./create-07671515.js";import"./light-20fa43af.js";import"./light-170bfcda.js";import"./Empty-3e1da814.js";import"./light-e632ba41.js";import"./create-ref-setter-ee697025.js";import"./light-bf1b7eb7.js";import"./light-a43afc3c.js";import"./Tooltip-f5342231.js";import"./_common-89f2509f.js";import"./light-a7677734.js";import"./_common-991711fd.js";import"./light-37eaa122.js";import"./use-houdini-1a86f12f.js";const K=e("newlybuild",!0,(function(e){return s("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[s("path",{d:"M19 10V7C19 5.89543 19.8954 5 21 5H41C42.1046 5 43 5.89543 43 7V29C43 30.1046 42.1046 31 41 31H37",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),s("rect",{x:"5",y:"18",width:"24",height:"24",rx:"2",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),s("path",{d:"M17 25V35",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),s("path",{d:"M12 30H22",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])})),Y=e("write",!0,(function(e){return s("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[s("path",{d:"M5.32497 43.4996L13.81 43.4998L44.9227 12.3871L36.4374 3.90186L5.32471 35.0146L5.32497 43.4996Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),s("path",{d:"M27.9521 12.3872L36.4374 20.8725",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])})),ee={key:0,class:"playlist"},se={class:"left"},ae={class:"cover"},te={class:"meta"},le={class:"title"},oe={class:"intr"},ie={class:"name"},re={class:"desc text-hidden"},ne={class:"right"},ce={class:"meta"},me={class:"num"},pe={class:"num"},ue={key:1,class:"title"},de={class:"key"},ge=(e=>(q("data-v-5b827119"),e=e(),D(),e))((()=>g("br",null,null,-1))),he={key:2,class:"loading"},ve={class:"left"},ke={class:"right"},je=a({__name:"PlayListView",setup(e){const{t:a}=t(),q=l(),D=o(),je=i(),ye=r(),fe=n(q.currentRoute.value.query.id),we=n(null),Le=n([]),$e=n(!1),be=n(30),Ce=n(!0),_e=n(q.currentRoute.value.query.page?Number(q.currentRoute.value.query.page):1),xe=n(0),Pe=e=>()=>f(S,{style:{transform:"translateX(2px)"}},{default:()=>e}),Te=e=>{const s=D.getUserPlayLists.like;return!s.length||!s.some((s=>s.id===Number(e)))},Me=e=>{const s=D.getUserPlayLists.own;return!!s.length&&s.some((s=>s.id===Number(e)))},Se=n([]),Ue=()=>{Se.value=[{key:"copy",label:a("menu.copy",{name:a("general.name.playlist"),other:a("general.name.link")}),props:{onClick:()=>{if(navigator.clipboard)try{navigator.clipboard.writeText(`https://music.163.com/#/playlist?id=${fe.value}`),$message.success(a("general.message.copySuccess"))}catch(e){console.error(a("general.message.copyFailure"),e),$message.error(a("general.message.copyFailure"))}else $message.error(a("general.message.notSupported"))}},icon:Pe(f(R))},{key:"del",label:a("menu.del"),show:D.userLogin&&Me(fe.value),props:{onClick:()=>{Ie(we.value)}},icon:Pe(f(Q))},{key:"like",label:Te(fe.value)?a("menu.collection",{name:a("general.name.playlist")}):a("menu.cancelCollection",{name:a("general.name.playlist")}),show:D.userLogin&&!Me(fe.value),props:{onClick:()=>{Ne(fe.value)}},icon:Pe(f(Te(fe.value)?E:W))}]},qe=e=>{w(e).then((e=>{xe.value=e.playlist.trackCount,we.value=e.playlist,$setSiteTitle(e.playlist.name+" - "+a("general.name.playlist"))})).catch((e=>{$setSiteTitle(a("general.name.playlist")),Ce.value=!1,console.error($message.error(a("general.message.acquisitionFailed")),e),$message.error(a("general.message.acquisitionFailed"))}))},De=(e,s=30,t=0)=>{L(e,s,t).then((s=>{s.songs?(Le.value=[],s.songs.forEach(((s,a)=>{Le.value.push({id:s.id,num:a+1+(_e.value-1)*be.value,name:s.name,artist:s.ar,album:s.al,alia:s.alia,time:$(s.dt),fee:s.fee,sourceId:e,pc:s.pc?s.pc:null,mv:s.mv?s.mv:null})}))):$message.error(a("general.message.acquisitionFailed")),"undefined"!=typeof $scrollToTop&&$scrollToTop()}))},Fe=()=>{try{const e=document.getElementById("datalists").firstElementChild,s=document.querySelectorAll("#datalists > *");let a=!1;if(s.forEach((e=>{e.classList.contains("play")&&(a=!0)})),a)je.setPlayState(!0);else{const s=new MouseEvent("dblclick",{bubbles:!0,cancelable:!0,view:window});"dblclick"===ye.listClickMode?e.dispatchEvent(s):"click"===ye.listClickMode&&e.click()}}catch(e){console.error($message.error(a("general.message.operationFailed")),e),$message.error($message.error(a("general.message.operationFailed")))}},Ie=e=>{var s;if(e.id===(null==(s=D.getUserPlayLists)?void 0:s.own[0].id))return $message.warning(a("menu.unableToDelete")),!1;$dialog.warning({class:"s-dialog",title:a("general.dialog.delete"),content:a("menu.delQuestion",{name:e.name}),positiveText:a("general.dialog.delete"),negativeText:a("general.dialog.cancel"),onPositiveClick:()=>{b(e.id).then((e=>{200===e.code&&($message.success(a("general.message.deleteSuccess")),D.setUserPlayLists(),q.push("/music/user/playlists"))}))}})},Ne=async e=>{const s=Te(e)?1:2,t=a("general.name.playlist"),l="zh-CN"===ye.language?"":" ";try{200===(await C(s,e)).code?($message.success(`${t+l}${a(1==s?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.success")})}`),D.setUserPlayLists((()=>{Ue()}))):$message.error(`${t+l}${a(1==s?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.failed")})}`)}catch(o){$message.error(`${t+l}${a(1==s?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.failed")})}`),console.error(`${t+l}${a(1==s?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.failed")})}`,o)}};c((()=>{fe.value&&(qe(fe.value),De(fe.value,be.value,(_e.value-1)*be.value),!D.userLogin||D.getUserPlayLists.has||D.getUserPlayLists.isLoading?Ue():D.setUserPlayLists((()=>{Ue()})))}));const He=e=>{be.value=e,De(fe.value,e,(_e.value-1)*be.value)},ze=e=>{q.push({path:"/music/playlist",query:{id:fe.value,page:e}})};return m((()=>q.currentRoute.value),((e,s)=>{fe.value=e.query.id,_e.value=Number(e.query.page?e.query.page:1),"playlist"==e.name&&(e.query.id!=s.query.id?(qe(fe.value),De(fe.value,be.value,(_e.value-1)*be.value)):De(fe.value,be.value,(_e.value-1)*be.value))})),(e,a)=>{var t,l;const o=B,i=_,r=X,n=V,c=Z,m=G,f=x,w=J;return p(we)?(u(),d("div",ee,[g("div",se,[g("div",ae,[s(o,{"show-toolbar-tooltip":"",class:"coverImg",src:p(H)(p(we).coverImgUrl,1024),"previewed-img-props":{style:{borderRadius:"8px"}},"preview-src":p(H)(p(we).coverImgUrl),"fallback-src":"/img/music/pic/default.png"},null,8,["src","preview-src"]),s(o,{"preview-disabled":"",class:"shadow",src:p(H)(p(we).coverImgUrl,1024),"fallback-src":"/img/music/pic/default.png"},null,8,["src"])]),g("div",te,[g("div",le,[s(p(O),{class:"name text-hidden"},{default:h((()=>[P(v(p(we).name),1)])),_:1}),s(p(O),{class:"creator"},{default:h((()=>[P(v(p(we).creator.nickname),1)])),_:1})]),g("div",oe,[g("span",ie,v(e.$t("general.name.desc",{name:e.$t("general.name.playlist")})),1),g("span",re,v(p(we).description?p(we).description:e.$t("other.noDesc")),1),(null==(l=null==(t=p(we))?void 0:t.description)?void 0:l.length)>70?(u(),k(i,{key:0,class:"all-desc",block:"",strong:"",secondary:"",onClick:a[0]||(a[0]=e=>$e.value=!0)},{default:h((()=>[P(v(e.$t("general.name.allDesc")),1)])),_:1})):j("",!0)]),p(we).tags?(u(),k(n,{key:0,class:"tag"},{default:h((()=>[(u(!0),d(T,null,M(p(we).tags,(e=>(u(),k(r,{class:"tags",round:"",bordered:!1,key:e,onClick:s=>p(q).push(`/music/discover/playlists?cat=${e}&page=1`)},{default:h((()=>[P(v(e),1)])),_:2},1032,["onClick"])))),128))])),_:1})):j("",!0),s(n,{class:"control"},{default:h((()=>[s(i,{strong:"",secondary:"",round:"",type:"primary",onClick:Fe},{icon:h((()=>[s(p(S),{component:p(z)},null,8,["component"])])),default:h((()=>[P(" "+v(e.$t("general.name.play")),1)])),_:1}),s(c,{placement:"right-start",trigger:"click","show-arrow":!0,options:p(Se)},{default:h((()=>[s(i,{strong:"",secondary:"",circle:""},{icon:h((()=>[s(p(S),{component:p(I)},null,8,["component"])])),_:1})])),_:1},8,["options"])])),_:1})])]),g("div",ne,[g("div",ce,[s(p(O),{class:"name"},{default:h((()=>[P(v(p(we).name),1)])),_:1}),s(p(O),{class:"creator"},{default:h((()=>[s(p(S),{depth:3,component:p(A)},null,8,["component"]),P(" "+v(p(we).creator.nickname),1)])),_:1}),s(n,{class:"time"},{default:h((()=>[g("div",me,[s(p(S),{depth:3,component:p(K)},null,8,["component"]),s(p(O),{innerHTML:p(U)(p(we).createTime)},null,8,["innerHTML"])]),g("div",pe,[s(p(S),{depth:3,component:p(Y)},null,8,["component"]),s(p(O),{innerHTML:p(U)(p(we).updateTime)},null,8,["innerHTML"])])])),_:1})]),s(F,{listData:p(Le)},null,8,["listData"]),s(N,{totalCount:p(xe),pageNumber:p(_e),showSizePicker:!1,showQuickJumper:!1,onPageSizeChange:He,onPageNumberChange:ze},null,8,["totalCount","pageNumber"]),s(f,{class:"s-modal",show:p($e),"onUpdate:show":a[1]||(a[1]=e=>y($e)?$e.value=e:null),preset:"card",title:e.$t("general.name.desc",{name:e.$t("general.name.playlist")}),bordered:!1},{default:h((()=>[s(m,null,{default:h((()=>[s(p(O),{innerHTML:p(we).description.replace(/\n/g,"<br>")},null,8,["innerHTML"])])),_:1})])),_:1},8,["show","title"])])])):p(fe)&&p(Ce)?(u(),d("div",he,[g("div",ve,[s(w,{class:"pic"}),s(w,{text:"",repeat:5}),s(w,{text:"",style:{width:"60%"}})]),g("div",ke,[s(w,{sharp:!1,height:"80px",width:"60%"}),s(w,{height:"100%",width:"100%"})])])):(u(),d("div",ue,[g("span",de,v(p(Ce)?e.$t("general.name.noKeywords"):e.$t("general.message.acquisitionFailed")),1),ge,s(i,{strong:"",secondary:"",onClick:a[2]||(a[2]=e=>p(q).go(-1)),style:{"margin-top":"20px"}},{default:h((()=>[P(v(e.$t("general.name.goBack")),1)])),_:1})]))}}},[["__scopeId","data-v-5b827119"]]);export{je as default};
