import{_ as e}from"./Alert-a6104c4f.js";import{e as t,f as a,S as n,o as s,c as r,d as o,j as u,a as l,w as i,b as v,u as c,g as d,t as m,k as p,q as y}from"./index-d93ecfd9.js";import"./_common-60fffae6.js";const h={class:"container"},f={class:"controls"},E={__name:"RandomVideo",setup(E){const g=t(null),L=t(null),b=t(!1),_=t(!1),k=t(!1),P=t(!1),C=["https://api.yviii.com/video/suiji.php","https://api.yviii.com/video/i.php","http://api.mhycloud.fun:81/api/dy"],j=e=>{b.value=e},w=async()=>{j(!0);const e=(()=>{const e=Math.floor(Math.random()*C.length);return C[e]})();if(e===g.value.src)return w();g.value.src=e;try{await g.value.play(),_.value=!0}catch(t){console.error("视频播放失败:",t),$message.error("视频播放失败")}g.value.oncanplay=()=>{j(!1)}},x=()=>{g.value.currentTime=0,g.value.play(),_.value=!0},I=()=>{g.value.paused?(g.value.play(),_.value=!0):(g.value.pause(),_.value=!1)},$=async()=>{try{document.pictureInPictureElement?await document.exitPictureInPicture():await g.value.requestPictureInPicture()}catch(e){console.error("画中画操作失败:",e),$message.error("画中画操作失败")}};return a((()=>{k.value="pictureInPictureEnabled"in document,w(),g.value.addEventListener("ended",w),g.value.addEventListener("play",(()=>{_.value=!0})),g.value.addEventListener("pause",(()=>{_.value=!1})),g.value.addEventListener("error",(e=>{console.error("视频加载错误:",e.target.error),$message.error("视频加载错误，将尝试下一个视频"),w()})),document.addEventListener("visibilitychange",(()=>{document.hidden&&(g.value.pause(),_.value=!1)})),document.addEventListener("gesturestart",(e=>{e.preventDefault()})),document.addEventListener("touchstart",(e=>{e.touches[0].clientY}),{passive:!1}),document.addEventListener("touchmove",(e=>{e.touches[0].clientY,e.target.matches("video")||e.preventDefault()}),{passive:!1})})),n((()=>{g.value&&(g.value.removeEventListener("ended",w),g.value.removeEventListener("play",(()=>{})),g.value.removeEventListener("pause",(()=>{})),g.value.removeEventListener("error",(()=>{}))),document.removeEventListener("visibilitychange",(()=>{})),document.removeEventListener("gesturestart",(()=>{})),document.removeEventListener("touchstart",(()=>{})),document.removeEventListener("touchmove",(()=>{}))})),(t,a)=>(s(),r("div",h,[o("div",{class:"video-container",ref_key:"videoContainer",ref:L},[o("video",{ref_key:"videoPlayer",ref:g,controls:"",class:u(["dance-video",{loading:b.value}])}," 您的浏览器不支持视频播放。 ",2)],512),o("div",f,[l(c(d),{type:"primary",class:"next-button",onClick:w,loading:b.value},{default:i((()=>[v(" 下一个 ")])),_:1},8,["loading"]),l(c(d),{type:"info",class:"refresh-button",onClick:x},{default:i((()=>[v(" 刷新 ")])),_:1}),l(c(d),{type:"warning",class:"play-toggle-button",onClick:I},{default:i((()=>[v(m(_.value?"暂停":"播放"),1)])),_:1}),l(c(d),{type:"success",class:"pip-button",onClick:$,disabled:!k.value},{default:i((()=>[v(" 画中画 ")])),_:1},8,["disabled"])]),P.value?(s(),p(c(e),{key:0,type:"success",class:"alert-box",onClose:a[0]||(a[0]=e=>P.value=!1)},{default:i((()=>[v(" 复制成功，请打开浏览器进行下载保存！ ")])),_:1})):y("",!0)]))}};export{E as default};
