import{a as e,l as s}from"./album-8a3f3da2.js";import{c2 as t,a as l,_ as a,cN as o,cB as r,cQ as i,cO as n,cM as c,e as m,f as p,Y as u,u as d,o as g,c as h,d as j,w as f,t as k,k as v,q as y,c8 as b,z as w,dj as $,g as _,cv as x,b as L,F as C,x as A,bO as M,de as T,p as U,l as D}from"./index-c72c5b0c.js";import{D as S,M as F}from"./DataLists-aff5237d.js";import{g as H}from"./getCoverUrl-bb08aa65.js";import{L as I,a as E}from"./LinkTwo-8d6bc0a2.js";import{U as P}from"./Unlike-d603c2d2.js";import{_ as z}from"./Image-6ba3d672.js";import{_ as N}from"./Space-5d75b1a8.js";import{_ as R}from"./text-64fc9966.js";import{M as q}from"./MusicList-4148cdec.js";import{P as B}from"./People-26086f57.js";import{T as O}from"./Time-69873e21.js";import{_ as W}from"./Tag-827106b2.js";import{_ as G}from"./Dropdown-db0b14d8.js";import{_ as K}from"./Scrollbar-4274af02.js";import{_ as V}from"./Skeleton-163a49d9.js";import"./AllArtists-b2fee903.js";import"./AddPlaylist-fbffd947.js";import"./CreatePlaylist-a7b4fb4f.js";import"./Input-b4caa030.js";import"./Suffix-af55cfcd.js";import"./index-92eb66c0.js";import"./use-merged-state-74230ec8.js";import"./light-6c88686a.js";import"./Checkbox-edaaabdb.js";import"./light-c071e0c7.js";import"./Avatar-62f97100.js";import"./utils-48198701.js";import"./light-4ec95d76.js";import"./SmallSongData-c72e9d99.js";import"./FormItem-e0127deb.js";import"./light-8d6c1748.js";import"./Popover-87b27d79.js";import"./light-cb0cf260.js";import"./Follower-ef4b8179.js";import"./next-frame-once-924ab492.js";import"./cssr-ed8d5782.js";import"./use-compitable-a1866e01.js";import"./InputNumber-3459a9d0.js";import"./Add-b088e338.js";import"./Alert-e807b2ba.js";import"./_common-60fffae6.js";import"./Radio-3c9720cb.js";import"./RadioGroup-b4b538f1.js";import"./light-5b209fbc.js";import"./get-slot-a0e67e91.js";import"./RecordDisc-b91e091f.js";import"./PlayOne-22adba7e.js";import"./DeleteFour-7678c621.js";import"./DrawerContent-eda0377e.js";import"./light-ae2f09ac.js";import"./light-bf1b7eb7.js";import"./light-a43afc3c.js";import"./Tooltip-f5342231.js";import"./_common-89f2509f.js";import"./light-a7677734.js";import"./_common-991711fd.js";import"./create-07671515.js";import"./light-37eaa122.js";import"./create-ref-setter-ee697025.js";import"./use-houdini-1a86f12f.js";const X=t("city",!0,(function(e){return l("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[l("path",{d:"M4 42H44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),l("rect",{x:"8",y:"26",width:"8",height:"16",rx:"2",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),l("path",{d:"M12 34H13",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),l("rect",{x:"16",y:"4",width:"24",height:"38",rx:"2",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),l("rect",{x:"22",y:"10",width:"4",height:"4",fill:e.colors[2]},null),l("rect",{x:"30",y:"10",width:"4",height:"4",fill:e.colors[2]},null),l("rect",{x:"22",y:"17",width:"4",height:"4",fill:e.colors[2]},null),l("rect",{x:"30",y:"17",width:"4",height:"4",fill:e.colors[2]},null),l("rect",{x:"30",y:"24",width:"4",height:"4",fill:e.colors[2]},null),l("rect",{x:"30",y:"31",width:"4",height:"4",fill:e.colors[2]},null)])})),Y=e=>(U("data-v-6d5c024c"),e=e(),D(),e),J={key:0,class:"album"},Q={class:"left"},Z={class:"cover"},ee=Y((()=>j("img",{src:"/img/music/pic/album.png",class:"album",alt:"album"},null,-1))),se={class:"meta"},te={class:"title"},le={class:"intr"},ae={class:"name"},oe={class:"desc text-hidden"},re={class:"right"},ie={class:"meta"},ne={class:"num"},ce={key:0,class:"num"},me={key:1,class:"title"},pe={class:"key"},ue=Y((()=>j("br",null,null,-1))),de={key:2,class:"loading"},ge={class:"left"},he={class:"right"},je=a({__name:"AlbumView",setup(t){const{t:a}=o(),U=r(),D=i(),Y=n(),je=c(),fe=m(U.currentRoute.value.query.id),ke=m(null),ve=m([]),ye=m(!1),be=e=>()=>w(M,{style:{transform:"translateX(2px)"}},{default:()=>e}),we=e=>{const s=D.getUserAlbumLists.list;return!s.length||!s.some((s=>s.id===Number(e)))},$e=m([]),_e=()=>{$e.value=[{key:"copy",label:a("menu.copy",{name:a("general.name.album"),other:a("general.name.link")}),props:{onClick:()=>{if(navigator.clipboard)try{navigator.clipboard.writeText(`https://music.163.com/#/playlist?id=${fe.value}`),$message.success(a("general.message.copySuccess"))}catch(e){console.error(a("general.message.copyFailure"),e),$message.error(a("general.message.copyFailure"))}else $message.error(a("general.message.notSupported"))}},icon:be(w(E))},{key:"like",label:we(fe.value)?a("menu.collection",{name:a("general.name.album")}):a("menu.cancelCollection",{name:a("general.name.album")}),show:D.userLogin,props:{onClick:()=>{Ce(fe.value)}},icon:be(w(we(fe.value)?I:P))}]},xe=s=>{e(s).then((e=>{ke.value=e.album,$setSiteTitle(e.album.name+" - "+a("general.name.album")),e.songs?(ve.value=[],e.songs.forEach(((e,t)=>{ve.value.push({id:e.id,num:t+1,name:e.name,artist:e.ar,album:e.al,alia:e.alia,time:$(e.dt),fee:e.fee,sourceId:s,pc:e.pc?e.pc:null,mv:e.mv?e.mv:null})}))):$message.error(a("general.message.acquisitionFailed"))}))},Le=()=>{try{const e=document.getElementById("datalists").firstElementChild,s=document.querySelectorAll("#datalists > *");let t=!1;if(s.forEach((e=>{e.classList.contains("play")&&(t=!0)})),t)Y.setPlayState(!0);else{const s=new MouseEvent("dblclick",{bubbles:!0,cancelable:!0,view:window});"dblclick"===je.listClickMode?e.dispatchEvent(s):"click"===je.listClickMode&&e.click()}}catch(e){console.error($message.error(a("general.message.operationFailed")),e),$message.error($message.error(a("general.message.operationFailed")))}},Ce=async e=>{const t=we(e)?1:2,l=a("general.name.album"),o="zh-CN"===je.language?"":" ";try{200===(await s(t,e)).code?($message.success(`${l+o}${a(1==t?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.success")})}`),D.setUserAlbumLists((()=>{_e()}))):$message.error(`${l+o}${a(1==t?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.failed")})}`)}catch(r){$message.error(`${l+o}${a(1==t?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.failed")})}`),console.error(`${l+o}${a(1==t?"menu.collection":"menu.cancelCollection",{name:a("general.dialog.failed")})}`,r)}};return p((()=>{fe.value&&(xe(fe.value),!D.userLogin||D.getUserAlbumLists.has||D.getUserAlbumLists.isLoading?_e():D.setUserAlbumLists((()=>{_e()})))})),u((()=>U.currentRoute.value),(e=>{fe.value=e.query.id,"album"==e.name&&xe(fe.value)})),(e,s)=>{var t;const a=z,o=_,r=W,i=N,n=G,c=K,m=x,p=V;return d(ke)?(g(),h("div",J,[j("div",Q,[j("div",Z,[l(a,{"show-toolbar-tooltip":"",class:"coverImg",src:d(H)(d(ke).picUrl,1024),"previewed-img-props":{style:{borderRadius:"8px"}},"preview-src":d(H)(d(ke).picUrl),"fallback-src":"/img/music/pic/default.png"},null,8,["src","preview-src"]),ee]),j("div",se,[j("div",te,[l(d(R),{class:"name"},{default:f((()=>[L(k(d(ke).name),1)])),_:1}),l(d(R),{class:"creator",onClick:s[0]||(s[0]=e=>d(U).push(`/music/artist/songs?id=${d(ke).artist.id}`))},{default:f((()=>[L(k(d(ke).artist.name),1)])),_:1})]),j("div",le,[j("span",ae,k(e.$t("general.name.desc",{name:e.$t("general.name.album")})),1),j("span",oe,k(d(ke).description?d(ke).description:e.$t("other.noDesc")),1),(null==(t=d(ke))?void 0:t.description.length)>70?(g(),v(o,{key:0,class:"all-desc",block:"",strong:"",secondary:"",onClick:s[1]||(s[1]=e=>ye.value=!0)},{default:f((()=>[L(k(e.$t("general.name.allDesc")),1)])),_:1})):y("",!0)]),d(ke).tags?(g(),v(i,{key:0,class:"tag"},{default:f((()=>[(g(!0),h(C,null,A(d(ke).tags,(e=>(g(),v(r,{class:"tags",round:"",bordered:!1,key:e},{default:f((()=>[L(k(e),1)])),_:2},1024)))),128))])),_:1})):y("",!0),l(i,{class:"control"},{default:f((()=>[l(o,{strong:"",secondary:"",round:"",type:"primary",onClick:Le},{icon:f((()=>[l(d(M),{component:d(q)},null,8,["component"])])),default:f((()=>[L(" "+k(e.$t("general.name.play")),1)])),_:1}),l(n,{placement:"right-start",trigger:"click","show-arrow":!0,options:d($e)},{default:f((()=>[l(o,{strong:"",secondary:"",circle:""},{icon:f((()=>[l(d(M),{component:d(F)},null,8,["component"])])),_:1})])),_:1},8,["options"])])),_:1})])]),j("div",re,[j("div",ie,[l(d(R),{class:"name"},{default:f((()=>[L(k(d(ke).name),1)])),_:1}),l(d(R),{class:"creator",onClick:s[2]||(s[2]=e=>d(U).push(`/music/artist/songs?id=${d(ke).artist.id}`))},{default:f((()=>[l(d(M),{depth:3,component:d(B)},null,8,["component"]),L(" "+k(d(ke).artist.name),1)])),_:1}),l(i,{class:"time"},{default:f((()=>[j("div",ne,[l(d(M),{depth:3,component:d(O)},null,8,["component"]),l(d(R),{innerHTML:d(T)(d(ke).publishTime)},null,8,["innerHTML"])]),d(ke).company?(g(),h("div",ce,[l(d(M),{depth:3,component:d(X)},null,8,["component"]),l(d(R),{innerHTML:d(ke).company},null,8,["innerHTML"])])):y("",!0)])),_:1})]),l(S,{listData:d(ve),hideAlbum:""},null,8,["listData"]),l(m,{class:"s-modal",show:d(ye),"onUpdate:show":s[3]||(s[3]=e=>b(ye)?ye.value=e:null),preset:"card",title:e.$t("general.name.desc",{name:e.$t("general.name.album")}),bordered:!1},{default:f((()=>[l(c,null,{default:f((()=>[l(d(R),{innerHTML:d(ke).description.replace(/\n/g,"<br>")},null,8,["innerHTML"])])),_:1})])),_:1},8,["show","title"])])])):d(fe)?(g(),h("div",de,[j("div",ge,[l(p,{class:"pic"}),l(p,{text:"",repeat:5}),l(p,{text:"",style:{width:"60%"}})]),j("div",he,[l(p,{sharp:!1,height:"80px",width:"60%"}),l(p,{height:"100%",width:"100%"})])])):(g(),h("div",me,[j("span",pe,k(e.$t("general.name.noKeywords")),1),ue,l(o,{strong:"",secondary:"",onClick:s[4]||(s[4]=e=>d(U).go(-1)),style:{"margin-top":"20px"}},{default:f((()=>[L(k(e.$t("general.name.goBack")),1)])),_:1})]))}}},[["__scopeId","data-v-6d5c024c"]]);export{je as default};
